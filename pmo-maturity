<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PMO Maturity Assessment — PwC</title>
<style>
/* ── DESIGN TOKENS ── */
:root {
  --o500: #FD5108;
  --o300: #FFAA72;
  --o100: #FFE8D4;
  --black: #000;
  --white: #fff;
  --g100: #EEEFF1;
  --g200: #DFE3E6;
  --g300: #CBD1D6;
  --g400: #B5BCC4;
  --g500: #A1A8B3;
  --success: #22C55E; --successBg: #DCFCE7;
  --warning: #EAB308; --warningBg: #FEF3C7;
  --error: #EF4444;   --errorBg: #FEE2E2;
  --info: #3B82F6;    --infoBg: #DBEAFE;
  --radius: 4px;
  --shadow: 0 1px 3px rgba(0,0,0,.08), 0 4px 16px rgba(0,0,0,.06);
  --shadow-md: 0 4px 24px rgba(0,0,0,.12);
}
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }
body {
  font-family: system-ui, -apple-system, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  background: var(--g100);
  color: var(--black);
  min-height: 100vh;
}
.hidden { display: none !important; }

/* ── TOP BAR ── */
.topbar {
  background: var(--white);
  border-bottom: 1px solid var(--g200);
  height: 64px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 32px;
  position: sticky;
  top: 0;
  z-index: 100;
  box-shadow: var(--shadow);
}
.topbar-left { display: flex; align-items: center; gap: 16px; }
.topbar-divider { width: 1px; height: 28px; background: var(--g200); flex-shrink: 0; }
.topbar-title { font-size: 15px; font-weight: 600; color: var(--black); }
.topbar-actions { display: flex; align-items: center; gap: 8px; }

/* ── BUTTONS ── */
.btn {
  display: inline-flex; align-items: center; justify-content: center; gap: 6px;
  font-family: inherit; font-weight: 600; font-size: 14px; cursor: pointer;
  border: none; border-radius: var(--radius); transition: all 0.15s ease;
  white-space: nowrap; padding: 10px 20px; line-height: 1;
}
.btn:focus-visible { outline: 2px solid var(--o500); outline-offset: 2px; }
.btn-primary { background: var(--o300); color: var(--black); border: 1px solid var(--o300); }
.btn-primary:hover { background: #f09a5e; border-color: #f09a5e; }
.btn-secondary { background: transparent; color: var(--black); border: 1px solid var(--black); }
.btn-secondary:hover { background: var(--g100); }
.btn-ghost { background: transparent; color: var(--g500); border: 1px solid var(--g200); }
.btn-ghost:hover { color: var(--black); border-color: var(--g400); background: var(--g100); }
.btn-sm { padding: 6px 14px; font-size: 12px; }
.btn:disabled, .btn.disabled { opacity: 0.5; cursor: not-allowed; pointer-events: none; }

/* ── PAGE LAYOUT ── */
.page { max-width: 960px; margin: 0 auto; padding: 28px 24px 56px; }

/* ── PROGRESS SECTION ── */
.progress-section {
  background: var(--white);
  border: 1px solid var(--g200);
  border-radius: var(--radius);
  padding: 14px 20px;
  margin-bottom: 20px;
  box-shadow: var(--shadow);
}
.progress-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
.step-label { font-size: 13px; font-weight: 600; color: var(--black); }
.step-count { font-size: 12px; color: var(--g400); font-weight: 500; }
.progress-track { width: 100%; height: 6px; background: var(--g200); border-radius: 3px; overflow: hidden; }
.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--o500) 0%, var(--o300) 100%);
  border-radius: 3px;
  transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  width: 0%;
}

/* ── STEP CARD ── */
.step-card {
  background: var(--white);
  border: 1px solid var(--g200);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  overflow: hidden;
  animation: fadeIn 0.2s ease;
}
.step-card-header {
  padding: 20px 28px;
  border-bottom: 2px solid var(--o100);
  background: linear-gradient(135deg, var(--white) 0%, var(--o100) 100%);
}
.step-card-title { font-size: 20px; font-weight: 700; color: var(--black); margin-bottom: 4px; }
.step-card-desc { font-size: 13px; color: var(--g500); max-width: 680px; }
.step-card-body { padding: 24px 28px; }
.step-card-footer {
  padding: 16px 28px;
  border-top: 1px solid var(--g200);
  background: var(--g100);
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
}

/* ── DOMAIN WEIGHTING ── */
.domain-grid { display: flex; flex-direction: column; gap: 10px; }
.domain-item {
  display: flex; align-items: center; gap: 14px;
  padding: 14px 16px;
  border: 1px solid var(--g200);
  border-radius: var(--radius);
  background: var(--white);
  transition: border-color 0.15s;
}
.domain-item:hover { border-color: var(--o300); }
.domain-item-icon {
  width: 34px; height: 34px; border-radius: 50%;
  background: var(--o100);
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0;
  font-size: 12px; font-weight: 700; color: var(--o500);
}
.domain-item-name { flex: 1; font-size: 14px; font-weight: 500; color: var(--black); }
.domain-item-count { font-size: 12px; color: var(--g400); white-space: nowrap; }
.domain-weight-input {
  width: 72px; padding: 7px 10px;
  border: 1px solid var(--g200); border-radius: var(--radius);
  font-size: 13px; font-family: inherit;
  background: var(--white); color: var(--black);
  text-align: center; transition: border-color 0.15s;
}
.domain-weight-input:focus { outline: none; border-color: var(--o500); box-shadow: 0 0 0 3px rgba(253,81,8,.1); }
.weight-unit { font-size: 12px; color: var(--g400); }

/* ── CAPABILITY ASSESSMENT ── */
.capability-header { display: flex; flex-direction: column; gap: 8px; }
.domain-badge {
  display: inline-flex; align-items: center;
  padding: 4px 12px;
  background: var(--o100); color: var(--o500);
  font-size: 11px; font-weight: 700;
  border-radius: 20px;
  text-transform: uppercase; letter-spacing: 0.08em;
  width: fit-content;
}
.capability-title { font-size: 22px; font-weight: 700; color: var(--black); line-height: 1.3; }
.capability-meta { font-size: 12px; color: var(--g400); }

/* ── MATURITY LEVEL OPTIONS (vertical card list) ── */
.maturity-label {
  font-size: 12px; font-weight: 700; color: var(--g500);
  text-transform: uppercase; letter-spacing: 0.08em;
  margin-bottom: 12px;
}
.maturity-list { display: flex; flex-direction: column; gap: 8px; }
.maturity-option {
  display: flex; align-items: flex-start; gap: 16px;
  padding: 16px;
  border: 2px solid var(--g200); border-radius: var(--radius);
  cursor: pointer; transition: all 0.15s ease;
  background: var(--white); user-select: none;
}
.maturity-option:hover { border-color: var(--o300); background: #fef9f7; }
.maturity-option.selected { border-color: var(--o500); background: var(--o100); }
.maturity-option-badge {
  width: 42px; height: 42px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0; font-size: 16px; font-weight: 700;
  border: 2px solid currentColor; transition: all 0.15s;
}
.maturity-option.selected .maturity-option-badge { background: var(--o500); color: var(--white); border-color: var(--o500); }
.lvl-1 .maturity-option-badge { color: var(--g400); }
.lvl-2 .maturity-option-badge { color: var(--warning); }
.lvl-3 .maturity-option-badge { color: var(--info); }
.lvl-4 .maturity-option-badge { color: var(--success); }
.lvl-5 .maturity-option-badge { color: var(--o500); }
.maturity-option-content { flex: 1; }
.maturity-option-name { font-size: 14px; font-weight: 700; color: var(--black); margin-bottom: 4px; }
.maturity-option-desc { font-size: 13px; color: var(--g500); line-height: 1.55; }
.maturity-option.selected .maturity-option-desc { color: #6b2d00; }
.maturity-check {
  width: 22px; height: 22px; border-radius: 50%;
  border: 2px solid var(--g300); flex-shrink: 0; margin-top: 10px;
  display: flex; align-items: center; justify-content: center;
  transition: all 0.15s;
}
.maturity-option.selected .maturity-check { background: var(--o500); border-color: var(--o500); }
.maturity-check-icon { display: none; }
.maturity-option.selected .maturity-check-icon { display: block; }

/* ── CAPABILITY WEIGHT ROW ── */
.cap-weight-row {
  display: flex; align-items: center; gap: 12px;
  padding: 14px 16px; margin-top: 16px;
  background: var(--g100); border-radius: var(--radius);
  border: 1px solid var(--g200);
}
.cap-weight-label { font-size: 13px; font-weight: 600; color: var(--g500); white-space: nowrap; }
.cap-weight-hint { font-size: 12px; color: var(--g400); flex: 1; }

/* ── RESULTS ── */
.results-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 24px; }
.stat-card {
  padding: 20px; border: 1px solid var(--g200);
  border-radius: var(--radius); background: var(--white);
}
.stat-icon {
  width: 36px; height: 36px; background: var(--o100);
  border-radius: var(--radius); display: flex; align-items: center;
  justify-content: center; margin-bottom: 12px; color: var(--o500);
}
.stat-label { font-size: 11px; font-weight: 700; color: var(--g500); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 4px; }
.stat-value { font-size: 28px; font-weight: 700; color: var(--black); line-height: 1; }
.stat-sub { font-size: 12px; color: var(--g400); margin-top: 4px; }

/* ── RESULTS TABLE ── */
.results-table { width: 100%; border-collapse: collapse; margin-bottom: 24px; font-size: 14px; }
.results-table th {
  background: var(--g100); padding: 10px 14px; text-align: left;
  font-size: 11px; font-weight: 700; text-transform: uppercase;
  letter-spacing: 0.08em; color: var(--g500); border-bottom: 2px solid var(--g200);
  white-space: nowrap;
}
.results-table td { padding: 12px 14px; border-bottom: 1px solid var(--g200); vertical-align: middle; }
.results-table tfoot td { font-weight: 700; background: var(--g100); border-top: 2px solid var(--g200); border-bottom: none; }
.score-cell { display: flex; align-items: center; gap: 10px; }
.score-bar { flex: 1; max-width: 100px; height: 6px; background: var(--g200); border-radius: 3px; overflow: hidden; }
.score-bar-fill { height: 100%; background: var(--o300); border-radius: 3px; transition: width 0.6s ease; }
.score-num { font-weight: 600; font-size: 14px; min-width: 32px; }

/* ── BADGES ── */
.badge { display: inline-flex; align-items: center; padding: 3px 10px; font-size: 11px; font-weight: 600; white-space: nowrap; border-radius: 20px; }
.badge-initial    { background: var(--errorBg);   color: var(--error);   }
.badge-developing { background: var(--warningBg); color: #92680a;        }
.badge-defined    { background: var(--infoBg);    color: #1d5eaa;        }
.badge-managed    { background: var(--successBg); color: #166534;        }
.badge-optimising { background: var(--o100);      color: var(--o500);    }

/* ── CHART ── */
.chart-wrap {
  background: var(--white); border: 1px solid var(--g200);
  border-radius: var(--radius); padding: 20px 24px; margin-bottom: 24px;
}
.chart-heading { font-size: 12px; font-weight: 700; color: var(--g500); text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 16px; }

/* ── SECTION DIVIDER ── */
.section-divider { height: 2px; background: linear-gradient(90deg, var(--o500) 0%, var(--o100) 100%); width: 40px; margin: 8px 0 20px; }

/* ── ANIMATIONS ── */
@keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

/* ── RESPONSIVE ── */
@media (max-width: 640px) {
  .topbar { padding: 0 16px; }
  .topbar-title { display: none; }
  .page { padding: 16px 12px 40px; }
  .step-card-header, .step-card-body, .step-card-footer { padding-left: 16px; padding-right: 16px; }
  .results-stats { grid-template-columns: 1fr 1fr; }
  .maturity-option { padding: 12px; gap: 12px; }
  .maturity-option-badge { width: 34px; height: 34px; font-size: 13px; }
}
@media (max-width: 400px) {
  .results-stats { grid-template-columns: 1fr; }
}
</style>
</head>
<body>

<!-- ── TOP BAR ── -->
<header class="topbar">
  <div class="topbar-left">
    <!-- PwC Logo (official wordmark + momentum mark) -->
    <a href="#" style="display:flex;align-items:center;text-decoration:none;flex-shrink:0" aria-label="PwC">
      <svg width="72" height="34" viewBox="30 143 440 212" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M355.041 233.765C339.717 236.206 331.925 247.425 331.925 267.214C331.925 287.003 342.331 300.403 358.334 300.403C365.762 300.403 372.508 297.962 386.732 291.054V307.155C369.682 314.894 359.642 317.335 345.94 317.335C331.088 317.335 320.629 313.44 312.052 304.766C303.319 296.092 298.926 284.561 298.926 271.784C298.926 243.322 320.158 224.104 351.118 224.104C371.67 224.104 385.842 233.453 385.842 247.165C385.842 255.995 379.252 262.072 369.473 262.072C364.454 262.072 360.323 260.773 355.041 257.709V233.869V233.765ZM279.472 271.732C293.173 254.54 298.037 247.632 298.037 239.166C298.037 230.7 291.343 224 282.348 224C276.805 224 271.837 226.597 269.431 229.298V264.305L246.944 294.066V226.234H225.555L190.045 284.717V226.234H177.756L145.489 234.024V242.231L163.061 243.997V315.725H185.809L219.907 260.098V315.725H244.8L279.42 271.732H279.472ZM77.6086 244.464C82.8381 243.841 85.4532 243.529 87.9111 243.529C102.763 243.529 110.764 253.294 110.764 271.732C110.764 293.495 100.933 304.818 82.6291 304.818C81.1125 304.818 80.0143 304.818 77.6086 304.714V244.464ZM77.6086 314.894C83.518 315.569 89.2708 315.777 92.7223 315.777C123.211 315.777 142.508 296.404 142.508 267.629C142.508 242.75 128.022 224.727 108.359 224.727C99.8346 224.727 94.1867 226.441 77.6086 236.258V224.26H68.4046L33 234.959V243.581H47.6429V343.928L34.4643 347.2V355.511H92.304V347.2L77.5564 343.928V314.894H77.6086Z" fill="#000"/>
        <path d="M338.568 199.173H242.029L258.45 172.112H354.99L338.568 199.173ZM468 145H371.463L355.042 172.06H451.579L468 145Z" fill="#FD5108"/>
      </svg>
    </a>
    <div class="topbar-divider"></div>
    <span class="topbar-title">PMO Maturity Assessment</span>
  </div>
  <div class="topbar-actions">
    <button id="save-btn" class="btn btn-ghost btn-sm">
      <svg width="13" height="13" viewBox="0 0 16 16" fill="none"><path d="M13 2H4.5L2 4.5V13a1 1 0 001 1h10a1 1 0 001-1V3a1 1 0 00-1-1z" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/><path d="M5.5 2v3.5h5V2M4.5 10h7v4h-7z" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/></svg>
      Save
    </button>
    <button id="reset-btn" class="btn btn-ghost btn-sm">
      <svg width="13" height="13" viewBox="0 0 16 16" fill="none"><path d="M13.5 8A5.5 5.5 0 112.5 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M2.5 4v4h4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
      Reset
    </button>
  </div>
</header>

<!-- ── MAIN ── -->
<main class="page">

  <!-- PROGRESS BAR -->
  <div class="progress-section">
    <div class="progress-header">
      <span class="step-label" id="step-label">Domain Weighting</span>
      <span class="step-count" id="step-count"></span>
    </div>
    <div class="progress-track">
      <div class="progress-fill" id="progress-bar"></div>
    </div>
  </div>

  <!-- STEP 0: DOMAIN WEIGHTING -->
  <div id="domain-step" class="step-card">
    <div class="step-card-header">
      <div class="step-card-title">Domain Weighting</div>
      <div class="section-divider"></div>
      <div class="step-card-desc">Assign relative importance to each domain. Values are normalised automatically — higher numbers indicate greater priority for your organisation.</div>
    </div>
    <div class="step-card-body">
      <div class="domain-grid" id="domain-grid"></div>
    </div>
    <div class="step-card-footer">
      <span></span>
      <button id="domain-next" class="btn btn-primary">
        Begin Assessment
        <svg width="14" height="14" viewBox="0 0 16 16" fill="none"><path d="M3 8h10M9 4l4 4-4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </button>
    </div>
  </div>

  <!-- STEP 1–N: CAPABILITY ASSESSMENT -->
  <div id="capability-step" class="step-card hidden">
    <div class="step-card-header">
      <div class="capability-header">
        <div class="domain-badge" id="cap-domain-badge">Domain</div>
        <div class="capability-title" id="cap-name">Capability</div>
        <div class="capability-meta" id="cap-meta"></div>
      </div>
    </div>
    <div class="step-card-body">
      <div class="maturity-label">Select the maturity level that best describes your organisation today</div>
      <div class="maturity-list" id="maturity-list"></div>
      <div class="cap-weight-row">
        <span class="cap-weight-label">Capability weight:</span>
        <input type="number" id="weight-input" class="domain-weight-input" min="0" step="0.01" value="1">
        <span class="cap-weight-hint">Relative importance within domain (normalised automatically)</span>
      </div>
    </div>
    <div class="step-card-footer">
      <button id="prev-btn" class="btn btn-secondary">
        <svg width="14" height="14" viewBox="0 0 16 16" fill="none"><path d="M13 8H3M7 4L3 8l4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        Previous
      </button>
      <button id="next-btn" class="btn btn-primary">
        Next
        <svg width="14" height="14" viewBox="0 0 16 16" fill="none"><path d="M3 8h10M9 4l4 4-4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </button>
    </div>
  </div>

  <!-- STEP N+1: RESULTS -->
  <div id="results-step" class="step-card hidden">
    <div class="step-card-header">
      <div class="step-card-title">Assessment Results</div>
      <div class="section-divider"></div>
      <div class="step-card-desc">Your PMO maturity profile across all domains, weighted by your inputs.</div>
    </div>
    <div class="step-card-body">
      <div class="results-stats" id="results-stats"></div>
      <table class="results-table">
        <thead>
          <tr>
            <th>Domain</th>
            <th>Maturity</th>
            <th style="min-width:180px">Weighted Score</th>
            <th>Avg Level</th>
          </tr>
        </thead>
        <tbody id="results-tbody"></tbody>
        <tfoot><tr id="results-tfoot-row"></tr></tfoot>
      </table>
      <div class="chart-wrap" id="chart-section">
        <div class="chart-heading">Domain Scores Overview</div>
        <canvas id="scoreChart" height="180"></canvas>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
      </div>
      <div id="rec-section"></div>
    </div>
    <div class="step-card-footer">
      <button id="results-prev-btn" class="btn btn-secondary">
        <svg width="14" height="14" viewBox="0 0 16 16" fill="none"><path d="M13 8H3M7 4L3 8l4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        Back to Assessment
      </button>
      <button onclick="window.print()" class="btn btn-primary">
        <svg width="14" height="14" viewBox="0 0 16 16" fill="none"><path d="M4 6V2h8v4M2 6h12v6H2V6zM5 11h6M5 9h4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
        Print / Export
      </button>
    </div>
  </div>

</main>

<script>
'use strict';
const levelNames = ['Initial', 'Developing', 'Defined', 'Managed', 'Optimising'];

const domainsData = JSON.parse(`{"Strategy & Portfolio Alignment": [{"name": "Strategic alignment of investments", "levels": ["Initiatives are approved and started without a documented link to strategic objectives, so alignment is assumed rather than demonstrated.", "Some initiatives cite strategic themes, but the linkage is not tested consistently in governance and is often incomplete.", "Every initiative documents its alignment to one or more strategic objectives, and that alignment is reviewed during approval.", "Strategic contribution is quantified through agreed scoring criteria, and prioritisation decisions consider relative strategic value.", "Portfolio composition is actively optimised using strategic performance data and scenario analysis to maximise strategic outcomes."]}, {"name": "Portfolio objectives clarity", "levels": ["The organisation does not have formally agreed portfolio objectives, so portfolio success criteria are unclear.", "Portfolio objectives are stated at a high level, but they are not translated into measurable targets or consistently communicated.", "Portfolio objectives are documented and communicated, and they are supported by measurable targets used in portfolio reporting.", "Objectives cascade into programme and initiative targets, and governance forums review progress against them on a defined cadence.", "Objectives are periodically recalibrated using realised value, external changes, and strategic shifts, with clear decision records."]}, {"name": "Benefits definition quality", "levels": ["Expected benefits are rarely quantified, and ownership for benefits is not clearly assigned.", "Benefits are estimated in business cases, but baselines, measurement methods, and owners are often missing or inconsistent.", "Benefits are defined with clear measures, baselines, timeframes, and named owners, and they are approved as part of governance.", "Benefits are tracked during delivery and after implementation, with regular review by accountable executives and corrective actions.", "Benefits realisation is continuously monitored and is used to refine investment decisions, prioritisation, and future business cases."]}, {"name": "Value measurement discipline", "levels": ["Portfolio value is not measured at an aggregate level, and decisions rely mainly on anecdote or local reporting.", "Some financial and delivery metrics are reported, but definitions vary and the portfolio view is fragmented.", "A consistent set of portfolio value measures is defined and reported, enabling meaningful comparison across initiatives.", "Value measures influence funding, sequencing, and reprioritisation decisions, and material variances trigger governance actions.", "Advanced analytics and leading indicators are used to forecast value delivery and to optimise portfolio decisions."]}, {"name": "Executive sponsorship maturity", "levels": ["Executive sponsorship is informal and varies by initiative, with limited commitment and unclear responsibilities.", "Sponsors are assigned, but expectations for decision-making, escalation, and benefits ownership are not consistently applied.", "Sponsor roles and accountabilities are documented, and sponsors routinely participate in governance decisions for their initiatives.", "Sponsors actively steer delivery, manage escalations, and remain accountable for benefits, including post-implementation outcomes.", "Sponsorship effectiveness is measured (for example, decision timeliness and outcomes) and improved through feedback and coaching."]}, {"name": "Strategy-to-delivery traceability", "levels": ["There is no reliable traceability from strategic objectives to business cases, plans, and delivery reporting.", "Some traceability exists in documents, but the links are incomplete and are not maintained as initiatives change.", "Business cases and reporting explicitly reference strategic objectives, and traceability is maintained through standard artefacts.", "Integrated reporting connects strategy, delivery status, risk, and benefits so governance can see end-to-end progress.", "Digital traceability provides near real-time visibility from strategic objectives to delivered outcomes and realised benefits."]}, {"name": "Portfolio review cadence", "levels": ["Portfolio reviews occur only when problems arise, and decisions are made without a consistent governance cadence.", "Portfolio reviews occur periodically, but agendas, inputs, and decision outputs are inconsistent and not reliably recorded.", "Portfolio reviews occur on a defined cadence with standard inputs, decisions, and recorded actions that are tracked to completion.", "Reviews include value, risk, capacity, and dependency analysis, and outcomes drive reprioritisation and corrective action.", "Reviews use leading indicators and scenario insights to proactively reshape the portfolio before issues materialise."]}], "Demand & Investment Governance": [{"name": "Demand intake discipline", "levels": ["Demand is raised through informal channels, resulting in inconsistent information and limited visibility of the demand pipeline.", "A common intake form exists, but it is not mandatory and submissions vary widely in completeness and quality.", "All demand follows a structured intake process with minimum data requirements, defined roles, and transparent status tracking.", "Intake is integrated with capacity, financial, and risk validation so that only viable demand progresses to decision forums.", "Demand intake is digitally enabled with automated validation, scoring, and prioritisation to support fast, consistent decisions."]}, {"name": "Business case rigour", "levels": ["Business cases are often missing or superficial, and decisions are made with limited analysis of cost, risk, and benefits.", "Business cases are required, but quality varies and key sections (assumptions, baselines, risks) are often incomplete.", "A standard business case template is enforced, including quantified costs, benefits, risks, and clear options analysis.", "Business cases include sensitivity analysis, dependency impacts, and benefits measurement plans, and they are reviewed by SMEs.", "Business cases are continuously improved using post-implementation results and scenario modelling to validate assumptions and forecasts."]}, {"name": "Investment approval governance", "levels": ["Approval decisions are informal and can be influenced by politics rather than documented criteria and evidence.", "Approval forums exist, but decision criteria are not consistently applied and rationale is not always recorded.", "Formal approval bodies operate with defined decision rights, standard criteria, and documented decision outcomes.", "Approvals consider strategic score, portfolio impact, capacity, risk, and interdependencies, supported by consistent analysis.", "Approval decisions are optimised using portfolio analytics and scenario modelling to maximise enterprise value within constraints."]}, {"name": "Funding transparency", "levels": ["Funding allocations are reactive and opaque, with limited clarity on why investments are funded or deferred.", "Budgets are approved, but ongoing funding visibility and tracking against allocation are inconsistent across initiatives.", "Funding is aligned to prioritisation outcomes, and budget allocations and changes are transparent and traceable.", "Funding is reallocated based on performance, risk, and changing priorities, supported by formal governance decisions.", "A rolling investment model optimises capital deployment across the portfolio, balancing strategic value and delivery confidence."]}, {"name": "Prioritisation consistency", "levels": ["Prioritisation is largely subjective, and different groups apply different criteria or none at all.", "Prioritisation criteria exist, but they are applied inconsistently and are not supported by robust scoring.", "Transparent scoring criteria are applied consistently, and prioritisation outcomes are documented and communicated.", "Prioritisation incorporates capacity, dependencies, risk, and benefits to enable enterprise-level trade-off decisions.", "Advanced optimisation approaches model multiple scenarios and constraints to recommend the best portfolio ordering."]}, {"name": "Stage gate enforcement", "levels": ["Stage gates are absent or routinely bypassed, so initiatives progress without consistent readiness checks.", "Stage gates exist, but artefact requirements and approvals are applied inconsistently across initiatives.", "A gated lifecycle is enforced, with defined entry and exit criteria, required artefacts, and accountable approvers.", "Gates validate value, risk, readiness, and funding, and outcomes drive corrective action or re-scoping where needed.", "Gate decisions use leading indicators and predictive insights to prevent downstream failure and optimise sequencing."]}, {"name": "Decision rights clarity", "levels": ["Decision authority is unclear, leading to delays, duplicated approvals, and inconsistent escalation.", "Roles are defined in places, but overlaps persist and escalation paths are not consistently followed.", "Decision rights, RACI, and escalation thresholds are documented and understood across the portfolio.", "Decision rights are consistently applied, and escalations are managed within defined timeframes and governance forums.", "Decision effectiveness is monitored (for example, cycle time and rework) and refined to improve timeliness and quality."]}], "Portfolio Planning & Optimisation": [{"name": "Capacity planning accuracy", "levels": ["Capacity planning is not performed, so commitments exceed available resources and shortages are discovered late.", "High-level capacity estimates are produced, but they are not regularly updated or reconciled with actual availability.", "Capacity planning uses defined assumptions and is integrated with the demand pipeline to inform feasible plans.", "Capacity forecasts are refreshed on a rolling basis and used in governance to reprioritise work and resolve conflicts.", "Predictive workforce and capacity modelling optimises allocation and highlights future constraints before they impact delivery."]}, {"name": "Scenario modelling capability", "levels": ["The organisation does not model scenarios, so trade-offs are made without understanding portfolio impacts.", "What-if analysis is performed ad hoc, typically in spreadsheets, with limited consistency or auditability.", "Structured scenario modelling is used during planning cycles, with documented assumptions and comparable options.", "Scenario analysis supports funding and prioritisation decisions, including capacity and dependency impacts.", "Near real-time scenario modelling supports continuous optimisation as constraints, priorities, and performance change."]}, {"name": "Portfolio balancing approach", "levels": ["The portfolio is not balanced across risk, value, compliance, and capacity, and it evolves mainly by accumulation.", "Basic financial balancing is attempted, but risk exposure and strategic mix are not consistently considered.", "The portfolio is balanced using agreed dimensions (for example, value, risk, regulatory, and strategic themes) and documented rules.", "Balancing is actively managed using performance trends and governance decisions to adjust mix and sequencing.", "Continuous optimisation balances multiple constraints and objectives, supported by analytics and scenario insights."]}, {"name": "Dependency management visibility", "levels": ["Dependencies are not identified consistently, so delivery plans conflict or fail due to hidden constraints.", "Dependencies are documented inconsistently and are not maintained as plans and priorities change.", "Dependencies are identified, recorded, and reviewed across programmes, with clear owners and mitigation actions.", "An enterprise dependency view is maintained and used to coordinate sequencing, resourcing, and risk management.", "Dependency impacts are modelled to predict schedule and value effects, enabling proactive portfolio adjustments."]}, {"name": "Long-range planning integration", "levels": ["Planning focuses on the short term, and there is no coherent multi-year view of the portfolio.", "An annual plan exists, but it is not integrated with portfolio governance or updated when conditions change.", "A multi-year roadmap aligns initiatives to strategy and major milestones, and it is used as the baseline for governance.", "Rolling planning updates long-range plans using forecasts, dependencies, and benefits profiles.", "Long-range planning incorporates external signals and strategic scenarios to adapt the roadmap dynamically."]}, {"name": "Reprioritisation responsiveness", "levels": ["Reprioritisation is delayed and reactive, so changes are implemented late and with limited stakeholder alignment.", "Reprioritisation occurs periodically, but triggers, criteria, and decision processes are not clearly defined.", "Formal reprioritisation triggers and processes exist, with documented trade-off decisions and clear communications.", "Value, risk, capacity, and progress data is used to reprioritise quickly and transparently through governance.", "Automated alerts and scenario insights support rapid reprioritisation, minimising disruption and maximising value."]}, {"name": "Resource-to-demand alignment", "levels": ["Demand routinely exceeds capacity, and allocation decisions are made locally without an enterprise view.", "Allocation tracking exists, but resourcing decisions are not consistently aligned to portfolio priorities.", "Resource allocation is aligned to prioritised demand, supported by agreed planning assumptions and governance.", "Resource conflicts are resolved centrally using clear trade-off criteria and documented decisions.", "Enterprise optimisation maximises utilisation and outcomes by continuously aligning resources to changing demand and performance."]}], "Delivery Frameworks & Ways of Working": [{"name": "Methodology consistency", "levels": ["Delivery approaches vary widely, and teams rely on individual preferences rather than a common framework.", "A delivery framework exists, but adoption is uneven and key controls are applied inconsistently.", "A standard delivery methodology is defined, supported by templates and training, and used for most initiatives.", "The methodology is embedded in governance and tooling, enabling consistent reporting, controls, and assurance.", "The methodology is continuously improved using performance data and lessons learned to increase predictability and outcomes."]}, {"name": "Hybrid delivery integration", "levels": ["Agile and waterfall approaches operate in silos, with limited alignment of governance and reporting.", "Some hybrid practices exist, but integration between delivery types is inconsistent and often manual.", "Hybrid governance is defined so that agile, predictive, and hybrid initiatives are managed using comparable controls.", "Portfolio reporting normalises measures across delivery types, supporting consistent decision-making and trade-offs.", "Adaptive operating practices optimise governance and delivery approaches based on context, risk, and value outcomes."]}, {"name": "Schedule forecasting accuracy", "levels": ["Schedules are unreliable and are not maintained, so forecasts provide little confidence for stakeholders.", "Forecasting is performed, but updates are inconsistent and variance is not systematically analysed.", "Forecasting follows defined controls (baselines, critical path, and update cadence) and is used consistently.", "Variance analysis informs corrective action, and forecast accuracy is monitored and improved over time.", "Predictive forecasting and leading indicators improve accuracy and provide early warning of delivery risk."]}, {"name": "Scope control discipline", "levels": ["Scope changes frequently without control, resulting in unclear baselines and unpredictable impacts on cost and schedule.", "Change control exists, but it is applied inconsistently and impact assessment is often incomplete.", "Formal change control is enforced with documented baselines, approvals, and impact analysis.", "Change decisions consider value, risk, benefits, and portfolio impacts, and they are governed transparently.", "Scope is actively optimised using value-based trade-offs to maximise outcomes within capacity and constraints."]}, {"name": "Change management rigour", "levels": ["Change impacts on people and operations are not managed, leading to low adoption and avoidable disruption.", "Stakeholder and change plans exist, but execution is inconsistent and adoption is not measured reliably.", "Structured change management is applied, including stakeholder engagement, communications, training, and readiness activities.", "Adoption and change outcomes are measured, and actions are taken to address resistance and capability gaps.", "Advanced insights (including behavioural and operational data) are used to optimise adoption and sustain change."]}, {"name": "Delivery risk management", "levels": ["Delivery risks are handled reactively, and risk information is not consistently captured or reviewed.", "Risk registers exist, but they are not maintained consistently and mitigation actions are not tracked reliably.", "Risks are identified, assessed, and managed using defined processes, with clear owners and a regular review cadence.", "Risk trends are analysed across the portfolio, and governance uses this information to intervene early.", "Leading risk indicators and predictive signals are embedded to prevent issues and improve delivery confidence."]}, {"name": "Lessons learned integration", "levels": ["Lessons learned are rarely captured, and mistakes are repeated across initiatives.", "Lessons are recorded in some cases, but they are not shared or used to improve future delivery.", "Lessons learned are captured systematically and are used to improve templates, standards, and planning.", "A knowledge repository is maintained and referenced during initiation and governance, supported by clear ownership.", "Continuous improvement is embedded, with measurable enhancements driven by lessons, metrics, and retrospective insights."]}], "Risk, Controls & Assurance": [{"name": "Enterprise risk alignment", "levels": ["Portfolio and project risks are not aligned to enterprise risk management, and risk reporting is inconsistent.", "Some mapping to enterprise risk categories exists, but it is incomplete and not maintained consistently.", "Risks are mapped to the enterprise risk taxonomy, with consistent reporting and defined escalation thresholds.", "Portfolio risk insights feed into enterprise reporting, and governance uses them to adjust priorities and controls.", "Integrated risk analytics provide an enterprise view of exposure, trends, and forward-looking indicators."]}, {"name": "Control framework integration", "levels": ["Controls are not clearly defined, and key delivery controls depend on individual practice rather than a standard.", "Some controls are documented, but they are applied inconsistently and evidence is not retained reliably.", "A standard control framework is defined and enforced, with clear control owners and evidence requirements.", "Control effectiveness is measured, issues are tracked to closure, and control performance informs governance decisions.", "Automated control monitoring and continuous assurance reduce manual effort and improve reliability."]}, {"name": "Assurance review effectiveness", "levels": ["Assurance reviews are ad hoc, and findings are not consistently recorded or actioned.", "Periodic reviews occur, but scope and methods vary and follow-up actions are inconsistent.", "A structured assurance approach is defined, with consistent scope, templates, and reporting.", "Findings are tracked with accountable owners and due dates, and progress is monitored through governance.", "Independent, risk-based assurance is embedded and is used to optimise governance, controls, and delivery performance."]}, {"name": "Compliance traceability", "levels": ["Compliance obligations relevant to the portfolio are unclear, and initiatives do not address them consistently.", "Obligations are identified in places, but tracking to delivery activities and evidence is inconsistent.", "Compliance requirements are mapped to initiatives, controls, and evidence artefacts using a consistent register.", "Compliance status is reported through governance, and gaps trigger remediation plans and assurance activities.", "Real-time compliance dashboards and auditable traceability support continuous compliance management."]}, {"name": "Issue escalation clarity", "levels": ["Issues are escalated informally, which leads to delays and inconsistent decision-making.", "Escalation paths exist, but thresholds are unclear and teams do not use them consistently.", "Escalation thresholds, paths, and decision forums are defined and applied consistently across initiatives.", "Escalations are analysed for systemic patterns, and governance uses this insight to address root causes.", "Escalation effectiveness is monitored and improved, reducing cycle time and recurring issues."]}, {"name": "Audit readiness", "levels": ["Audit preparation is reactive, and required evidence is gathered late and inconsistently.", "Some documentation exists, but evidence is incomplete or dispersed across teams and systems.", "Evidence is centrally maintained with defined standards, enabling timely and consistent audit responses.", "Audit outcomes are analysed and used to strengthen controls, governance, and evidence practices.", "Continuous audit readiness is maintained through standard evidence routines and periodic self-assessments."]}, {"name": "Remediation governance", "levels": ["Remediation actions are not managed centrally, so issues remain open and accountability is unclear.", "Remediation is tracked in some areas, but prioritisation, ownership, and follow-up are inconsistent.", "Formal remediation plans are required, with owners, due dates, and governance oversight.", "Remediation progress is monitored through governance, and ageing issues trigger escalation and intervention.", "Root causes are systematically addressed and prevented through controls strengthening and continuous improvement."]}], "Financial Management & Benefits": [{"name": "Cost forecasting reliability", "levels": ["Cost forecasts are frequently inaccurate, and there is limited transparency over assumptions and cost drivers.", "Forecasting is performed, but methods vary and forecasts are not consistently updated or reconciled to actuals.", "Forecasting follows defined standards (assumptions, update cadence, and variance analysis) and is applied consistently.", "Forecast accuracy is monitored, and variance drivers are managed through corrective actions and governance decisions.", "Predictive cost modelling improves accuracy and supports proactive interventions to optimise spend and outcomes."]}, {"name": "Budget control discipline", "levels": ["Budget controls are weak, and initiatives exceed budgets without timely visibility or governance action.", "Budget tracking exists, but reporting cadence and control discipline are inconsistent across initiatives.", "Budget baselines, controls, and reporting are defined, and variances are managed through standard governance processes.", "Financial dashboards support decision-making, and funding adjustments are made using transparent criteria and evidence.", "Portfolio-level budget optimisation reallocates funding to maximise value and manage risk, using rolling forecasts."]}, {"name": "Benefits realisation tracking", "levels": ["Benefits are not tracked after delivery, so realised outcomes are largely unknown.", "Benefits are tracked during delivery in some cases, but post-implementation measurement is inconsistent.", "Benefits are tracked through the initiative lifecycle with defined measures, owners, and a review cadence.", "Post-implementation reviews validate benefits, and shortfalls trigger remediation actions and accountability.", "Benefits insights are used to refine strategy, prioritisation, and business case assumptions across the portfolio."]}, {"name": "Financial variance management", "levels": ["Cost and budget variances are not managed systematically, and issues are discovered late.", "Variances are reported, but thresholds and corrective actions are applied inconsistently.", "Variance thresholds are defined, variances are analysed, and actions are tracked to closure.", "Root causes are identified and addressed, and governance monitors recurring variance patterns for systemic improvement.", "Trend analytics and leading indicators reduce variance and improve predictability across the portfolio."]}, {"name": "Investment performance reporting", "levels": ["Investment performance is not reported consistently, and stakeholders lack a clear view of cost versus value.", "Basic financial reporting exists, but it is not integrated with delivery status, risk, and benefits information.", "Integrated reporting covers cost, schedule, risk, and benefits so performance can be compared across investments.", "Governance uses performance dashboards to make trade-offs, adjust funding, and intervene early on underperformance.", "Forward-looking performance insights forecast outcomes and support optimisation of the investment mix."]}, {"name": "Capex / Opex governance", "levels": ["Capex and opex classification and governance are unclear, leading to inconsistent treatment and reporting.", "Spend is categorised, but controls and decision rules for capex versus opex are inconsistently applied.", "Governance rules and decision criteria are defined for capex and opex, and they are applied consistently.", "Lifecycle cost visibility supports decisions, including operating costs, depreciation impacts, and ongoing run costs.", "Capital allocation is optimised using total cost of ownership and value outcomes across the portfolio."]}, {"name": "Post-implementation review rigour", "levels": ["Post-implementation reviews are not conducted, so outcomes and lessons are not validated.", "Reviews occur inconsistently and are not supported by standard templates or governance expectations.", "Post-implementation reviews are mandatory, using defined templates and evidence to assess outcomes against plans.", "Findings from reviews influence future funding, governance controls, and delivery practices.", "Post-implementation insights are systematically embedded into an optimisation loop for continuous improvement."]}], "Resource & Capability Management": [{"name": "Resource demand forecasting", "levels": ["Resource demand is not forecasted, so shortages and bottlenecks are discovered late.", "Headcount estimates exist, but they are not tied to prioritised demand and are not updated consistently.", "Resource demand forecasts are aligned to the portfolio plan, with clear assumptions and ownership.", "Rolling forecasts inform hiring, sourcing, and reprioritisation decisions through governance.", "Predictive models anticipate demand shifts and optimise sourcing and allocation before constraints emerge."]}, {"name": "Skills capability mapping", "levels": ["There is no reliable view of workforce skills, so capability gaps are identified informally.", "A partial skills register exists, but coverage and accuracy are inconsistent and quickly become outdated.", "Skills are mapped to roles and portfolio needs, enabling planned capability uplift and targeted resourcing.", "Capability gaps are proactively managed through training, hiring, and workforce planning, with measurable outcomes.", "Strategic workforce planning optimises capability supply and demand using data-driven insights and scenario planning."]}, {"name": "Role clarity and accountability", "levels": ["Roles and accountabilities are unclear, leading to duplication, gaps, and inconsistent decision-making.", "Role definitions exist, but they are not consistently applied and accountability is not enforced.", "Role accountabilities are clearly defined (for example, via RACI) and applied consistently across initiatives and governance.", "Accountability is reinforced through performance measures, governance routines, and timely escalation of non-compliance.", "Role effectiveness is reviewed and improved, reducing hand-offs, rework, and delivery friction."]}, {"name": "Capacity optimisation", "levels": ["Capacity is poorly managed, with frequent over-allocation, under-utilisation, and conflicting priorities.", "Capacity is monitored, but balancing decisions are inconsistent and not supported by enterprise governance.", "Capacity is balanced across the portfolio using agreed rules and prioritisation, with transparent allocation decisions.", "Resource trade-offs are governed centrally, and capacity constraints drive reprioritisation and sequencing decisions.", "Optimisation approaches maximise utilisation and outcomes, continuously adjusting allocation to demand and performance."]}, {"name": "Workforce planning integration", "levels": ["Workforce planning is disconnected from the portfolio roadmap and delivery commitments.", "Some coordination exists, but workforce plans are not consistently updated to reflect portfolio changes.", "Workforce planning is aligned to the portfolio roadmap, including hiring, training, and sourcing plans.", "Scenario modelling informs workforce decisions, enabling proactive responses to changing demand and constraints.", "Dynamic workforce optimisation integrates demand signals, performance data, and market conditions to adjust plans."]}, {"name": "Vendor resource governance", "levels": ["Vendor resourcing is unmanaged, and performance expectations are unclear or not monitored.", "Contracts are managed, but oversight of vendor delivery performance and realised value is inconsistent.", "Vendor performance is monitored using defined measures, governance routines, and clear accountability.", "Vendor outcomes are assessed against delivery and benefits, and sourcing decisions reflect performance evidence.", "Vendor strategy is optimised across the portfolio, balancing capability, cost, risk, and performance outcomes."]}, {"name": "PM capability development", "levels": ["Project and programme management capability development is ad hoc, with limited standards or progression.", "Training is provided, but it is not linked to a defined competency framework or role requirements.", "A PM competency framework exists, and development plans are aligned to roles and portfolio needs.", "Capability uplift is tracked and linked to performance outcomes, and communities of practice reinforce standards.", "A continuous professional development culture is embedded, with measurable improvements in delivery performance."]}], "Data, Reporting & Insights": [{"name": "Single source of truth integrity", "levels": ["Portfolio data is fragmented across multiple tools and spreadsheets, with inconsistent definitions and ownership.", "Multiple systems are used, and data is only partially reconciled, limiting trust in portfolio reporting.", "A central repository exists with defined data standards and ownership, enabling consistent portfolio reporting.", "Data governance controls maintain accuracy and timeliness, and data quality is monitored and addressed.", "An integrated data ecosystem provides near real-time, reliable portfolio data across systems of record."]}, {"name": "KPI framework definition", "levels": ["Portfolio KPIs are not clearly defined, so reporting focuses on activity rather than outcomes.", "Some KPIs exist, but definitions vary and KPIs are not consistently used in governance decisions.", "A standard KPI framework is defined, including definitions, calculation methods, owners, targets, and reporting cadence.", "KPI performance is reviewed in governance, and results drive decisions, escalations, and corrective actions.", "Leading KPIs and predictive indicators support proactive management and portfolio optimisation."]}, {"name": "Executive dashboard quality", "levels": ["Executive reporting is largely manual, static, and slow, limiting timely decision-making.", "Basic dashboards exist, but data quality issues and inconsistent definitions reduce confidence in the information.", "Interactive dashboards present consistent measures and are used routinely in executive governance.", "Dashboards integrate value, risk, capacity, and dependencies, enabling exception-focused executive decision-making.", "Advanced analytics and predictive views provide early warning and optimisation insights for executives."]}, {"name": "Data ownership clarity", "levels": ["Data ownership is not defined, resulting in unclear accountability for accuracy and updates.", "Ownership is defined for some data elements, but stewardship is inconsistent and not enforced.", "Data stewardship roles are defined and applied, with clear responsibilities for quality, timeliness, and definitions.", "Data quality metrics are monitored centrally, and issues trigger remediation with accountable owners.", "Data governance is continuously improved, with automated controls and ongoing refinement of standards."]}, {"name": "Reporting automation level", "levels": ["Reporting is predominantly manual, requiring significant effort and increasing the risk of errors.", "Some reporting is automated, but critical outputs still require manual consolidation and correction.", "Automated reporting supports standard portfolio views, reducing manual effort and improving consistency.", "Dashboards provide near real-time views, and reporting is integrated with governance cadences and decision forums.", "Self-service analytics and automation enable scalable reporting and rapid insight generation."]}, {"name": "Data quality controls", "levels": ["Data quality is not validated, and reporting frequently contains errors or inconsistencies.", "Basic validation checks exist, but they are not consistently applied, monitored, or enforced.", "Data quality standards and controls are defined and enforced, including validation routines and exception handling.", "Data quality is measured, trends are monitored, and remediation is managed through governance with clear ownership.", "Automated anomaly detection and controls continuously improve data quality and reliability."]}, {"name": "Insight-driven decision support", "levels": ["Decisions are largely intuition-based, and reporting is used mainly for retrospective status updates.", "Reports inform discussions, but decisions are not consistently driven by data and structured analysis.", "Insights are routinely presented in governance forums, and decisions reference agreed measures and supporting evidence.", "Data is used to evaluate trade-offs, allocate resources, and manage risks with transparency and accountability.", "Advanced analytics provide optimisation recommendations, and decision outcomes are measured and refined over time."]}], "PMO Structure, Mandate & Value": [{"name": "PMO mandate clarity", "levels": ["The PMO\u2019s purpose and authority are unclear, resulting in inconsistent expectations and limited influence.", "The mandate is informally understood, but it is not formally approved or consistently applied across the organisation.", "The PMO mandate is formally approved, communicated, and reflected in governance roles and responsibilities.", "The mandate is aligned to enterprise strategy and guides portfolio governance and service delivery.", "The mandate is periodically reviewed and updated based on performance, stakeholder needs, and strategic change."]}, {"name": "Service catalogue definition", "levels": ["PMO services are not defined, and support is provided inconsistently based on local requests.", "A basic list of services exists, but service scope, standards, and responsibilities are unclear.", "A service catalogue defines PMO offerings, service levels, and responsibilities, and it is applied consistently.", "Services are measured against defined service levels, and performance is reviewed with stakeholders and governance.", "Services are continuously optimised based on demand, outcomes, and feedback, improving value and efficiency."]}, {"name": "PMO performance measurement", "levels": ["PMO performance is not measured, so value is asserted rather than demonstrated.", "Activity metrics are tracked (for example, reports produced), but outcome measures are limited.", "Outcome-based KPIs measure PMO contribution (for example, predictability and governance effectiveness) and are reported regularly.", "Performance is reviewed in governance forums, and improvement actions are prioritised and tracked to completion.", "The PMO demonstrates ROI and continuous improvement through measurable impacts on portfolio outcomes."]}, {"name": "Governance model maturity", "levels": ["Governance is fragmented, with inconsistent forums, unclear decision rights, and variable discipline.", "Governance forums exist, but agendas, inputs, and decision records are not consistent or complete.", "A structured governance model defines forums, cadence, inputs, decisions, and escalation paths.", "Governance is integrated across the enterprise, enabling consistent portfolio-level decisions and oversight.", "Governance is continuously refined using performance insights, assurance findings, and stakeholder feedback."]}, {"name": "Stakeholder satisfaction measurement", "levels": ["Stakeholder feedback is not captured, so PMO services are not adjusted based on user needs.", "Feedback is collected occasionally, but it is not systematic and does not consistently drive improvement.", "Regular stakeholder satisfaction measurement is implemented with clear questions, coverage, and reporting.", "Feedback is analysed and used to prioritise improvements, and outcomes are communicated to stakeholders.", "Stakeholder value is actively optimised using feedback trends, segmentation, and targeted service improvements."]}, {"name": "Continuous improvement discipline", "levels": ["There is no formal improvement cycle, and improvements occur only when issues become severe.", "Improvements are reactive and are not managed through a consistent backlog or governance process.", "A structured continuous improvement process exists, with an improvement backlog, prioritisation, and clear ownership.", "Improvement outcomes are measured, and benefits are tracked to demonstrate impact and sustain changes.", "Continuous improvement is embedded culturally, supported by data, regular retrospectives, and ongoing optimisation."]}, {"name": "PMO strategic influence", "levels": ["The PMO is primarily administrative and has limited input into investment or strategic decisions.", "The PMO provides advice in some cases, but influence depends on relationships rather than formal role.", "The PMO contributes to investment decisions through standard analysis, governance support, and portfolio insights.", "The PMO shapes portfolio design and strategic planning by providing integrated views of value, risk, and capacity.", "The PMO is recognised as a strategic partner and continuously increases influence through demonstrable outcomes."]}]}`);


// ── BUILD DOMAIN LIST AND CAPABILITIES ──────────────────
const domainNames = Object.keys(domainsData);
const domainWeightInputs = {};
const capabilities = [];

domainNames.forEach(domain => {
  const caps = domainsData[domain];
  const defaultWeight = 1 / caps.length;
  caps.forEach(cap => {
    capabilities.push({ domain, name: cap.name, levels: cap.levels, defaultWeight });
  });
});
const totalSteps = capabilities.length + 1; // domain weighting + N capabilities

// ── STATE ─────────────────────────────────────────────────
const selections = capabilities.map(cap => ({ level: 1, weight: cap.defaultWeight }));
let currentStep = 0; // 0 = domain, 1..N = capabilities, N+1 = results

// ── DOM REFERENCES ────────────────────────────────────────
const stepLabelEl   = document.getElementById('step-label');
const stepCountEl   = document.getElementById('step-count');
const progressBarEl = document.getElementById('progress-bar');
const domainStepDiv = document.getElementById('domain-step');
const capStepDiv    = document.getElementById('capability-step');
const resultsStepDiv= document.getElementById('results-step');
const domainNextBtn = document.getElementById('domain-next');
const prevBtn       = document.getElementById('prev-btn');
const nextBtn       = document.getElementById('next-btn');
const resultsPrevBtn= document.getElementById('results-prev-btn');
const saveBtn       = document.getElementById('save-btn');
const resetBtn      = document.getElementById('reset-btn');

// ── BUILD DOMAIN GRID ─────────────────────────────────────
function buildDomainGrid() {
  const grid = document.getElementById('domain-grid');
  grid.innerHTML = '';
  domainNames.forEach((domain, idx) => {
    const caps = domainsData[domain];
    const item = document.createElement('div');
    item.className = 'domain-item';

    const icon = document.createElement('div');
    icon.className = 'domain-item-icon';
    icon.textContent = String.fromCharCode(65 + idx); // A, B, C...

    const nameEl = document.createElement('div');
    nameEl.className = 'domain-item-name';
    nameEl.textContent = domain;

    const countEl = document.createElement('div');
    countEl.className = 'domain-item-count';
    countEl.textContent = `${caps.length} capabilities`;

    const wrapEl = document.createElement('div');
    wrapEl.style.cssText = 'display:flex;align-items:center;gap:8px;flex-shrink:0';

    const input = document.createElement('input');
    input.type = 'number';
    input.min = '0';
    input.step = '0.01';
    input.value = (1 / domainNames.length).toFixed(3);
    input.className = 'domain-weight-input';
    domainWeightInputs[domain] = input;

    const unit = document.createElement('span');
    unit.className = 'weight-unit';
    unit.textContent = 'wt';

    wrapEl.appendChild(input);
    wrapEl.appendChild(unit);
    item.appendChild(icon);
    item.appendChild(nameEl);
    item.appendChild(countEl);
    item.appendChild(wrapEl);
    grid.appendChild(item);
  });
}

// ── PERSISTENCE ───────────────────────────────────────────
function loadSavedProgress() {
  const saved = localStorage.getItem('pmoMaturityAssessment');
  if (!saved) return;
  try {
    const data = JSON.parse(saved);
    if (data.domainWeights) {
      domainNames.forEach(d => {
        if (data.domainWeights[d] !== undefined) {
          domainWeightInputs[d].value = data.domainWeights[d];
        }
      });
    }
    if (data.selections && Array.isArray(data.selections)) {
      data.selections.forEach((sel, idx) => {
        if (selections[idx]) {
          if (typeof sel.level === 'number') selections[idx].level = sel.level;
          if (typeof sel.weight === 'number') selections[idx].weight = sel.weight;
        }
      });
    }
    if (typeof data.currentStep === 'number') {
      currentStep = Math.min(data.currentStep, totalSteps);
    }
  } catch (err) {
    console.warn('Failed to load saved progress', err);
  }
}

function saveProgress(quiet = true) {
  const data = { domainWeights: {}, selections, currentStep };
  domainNames.forEach(d => {
    const val = parseFloat(domainWeightInputs[d].value);
    data.domainWeights[d] = isNaN(val) ? 0 : val;
  });
  try {
    localStorage.setItem('pmoMaturityAssessment', JSON.stringify(data));
    if (!quiet) alert('Progress saved. You can resume later.');
  } catch (err) {
    console.warn('Failed to save progress', err);
  }
}

function resetProgress() {
  if (!confirm('Reset all assessment progress? This cannot be undone.')) return;
  localStorage.removeItem('pmoMaturityAssessment');
  domainNames.forEach(d => {
    domainWeightInputs[d].value = (1 / domainNames.length).toFixed(3);
  });
  selections.forEach((sel, idx) => {
    sel.level = 1;
    sel.weight = capabilities[idx].defaultWeight;
  });
  currentStep = 0;
  showStep();
}

// ── EVENT LISTENERS ───────────────────────────────────────
saveBtn.addEventListener('click', () => saveProgress(false));
resetBtn.addEventListener('click', resetProgress);

domainNextBtn.addEventListener('click', () => {
  currentStep = 1;
  saveProgress();
  showStep();
});

prevBtn.addEventListener('click', () => {
  if (currentStep > 0) { currentStep--; saveProgress(); showStep(); }
});

nextBtn.addEventListener('click', () => {
  if (currentStep <= capabilities.length) { currentStep++; saveProgress(); showStep(); }
});

resultsPrevBtn.addEventListener('click', () => {
  currentStep = capabilities.length;
  saveProgress();
  showStep();
});

// ── PROGRESS UI ───────────────────────────────────────────
function updateProgressUI() {
  const total = totalSteps + 1;
  const current = currentStep + 1;

  if (currentStep === 0) {
    stepLabelEl.textContent = 'Domain Weighting';
  } else if (currentStep >= 1 && currentStep <= capabilities.length) {
    const cap = capabilities[currentStep - 1];
    stepLabelEl.textContent = `${cap.domain} — ${cap.name}`;
  } else {
    stepLabelEl.textContent = 'Results';
  }

  stepCountEl.textContent = `Step ${current} of ${total}`;
  const percent = (currentStep / totalSteps) * 100;
  progressBarEl.style.width = `${Math.min(percent, 100)}%`;
}

// ── SHOW STEP ─────────────────────────────────────────────
function showStep() {
  updateProgressUI();
  domainStepDiv.classList.add('hidden');
  capStepDiv.classList.add('hidden');
  resultsStepDiv.classList.add('hidden');

  if (currentStep === 0) {
    domainStepDiv.classList.remove('hidden');
  } else if (currentStep >= 1 && currentStep <= capabilities.length) {
    capStepDiv.classList.remove('hidden');
    const isLast = currentStep === capabilities.length;
    nextBtn.innerHTML = isLast
      ? 'Calculate Results <svg width="14" height="14" viewBox="0 0 16 16" fill="none"><path d="M3 8h10M9 4l4 4-4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>'
      : 'Next <svg width="14" height="14" viewBox="0 0 16 16" fill="none"><path d="M3 8h10M9 4l4 4-4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
    showCapability();
  } else {
    resultsStepDiv.classList.remove('hidden');
    calculateResults();
  }
}

// ── SHOW CAPABILITY (maturity level cards) ────────────────
function showCapability() {
  const idx = currentStep - 1;
  const cap = capabilities[idx];

  document.getElementById('cap-domain-badge').textContent = cap.domain;
  document.getElementById('cap-name').textContent = cap.name;

  const domCaps = capabilities.filter(c => c.domain === cap.domain);
  const posInDomain = domCaps.findIndex(c => c.name === cap.name) + 1;
  document.getElementById('cap-meta').textContent =
    `Capability ${posInDomain} of ${domCaps.length} in this domain`;

  // Build maturity option cards
  const list = document.getElementById('maturity-list');
  list.innerHTML = '';

  cap.levels.forEach((desc, i) => {
    const levelNum = i + 1;
    const isSelected = selections[idx].level === levelNum;
    const opt = document.createElement('div');
    opt.className = `maturity-option lvl-${levelNum}${isSelected ? ' selected' : ''}`;
    opt.innerHTML = `
      <div class="maturity-option-badge">${levelNum}</div>
      <div class="maturity-option-content">
        <div class="maturity-option-name">Level ${levelNum}: ${levelNames[i]}</div>
        <div class="maturity-option-desc">${desc}</div>
      </div>
      <div class="maturity-check">
        <svg class="maturity-check-icon" width="12" height="12" viewBox="0 0 12 12" fill="none">
          <path d="M2 6l3 3 5-5" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </div>
    `;
    opt.addEventListener('click', () => {
      selections[idx].level = levelNum;
      list.querySelectorAll('.maturity-option').forEach(el => el.classList.remove('selected'));
      opt.classList.add('selected');
    });
    list.appendChild(opt);
  });

  // Capability weight input
  const weightInput = document.getElementById('weight-input');
  weightInput.value = selections[idx].weight.toFixed(3);
  weightInput.onchange = () => {
    const val = parseFloat(weightInput.value);
    selections[idx].weight = isNaN(val) ? 0 : val;
  };
}

// ── MATURITY LABEL HELPER ─────────────────────────────────
function getMaturityLabel(score) {
  if (score < 1.5) return { label: 'Initial',    cls: 'badge-initial'    };
  if (score < 2.5) return { label: 'Developing', cls: 'badge-developing' };
  if (score < 3.5) return { label: 'Defined',    cls: 'badge-defined'    };
  if (score < 4.5) return { label: 'Managed',    cls: 'badge-managed'    };
  return             { label: 'Optimising', cls: 'badge-optimising' };
}

// ── CALCULATE RESULTS ─────────────────────────────────────
function calculateResults() {
  // Normalise domain weights
  const domWeights = {};
  let domSum = 0;
  domainNames.forEach(d => {
    const val = parseFloat(domainWeightInputs[d].value) || 0;
    domWeights[d] = val;
    domSum += val;
  });
  if (domSum === 0) domSum = 1;
  domainNames.forEach(d => { domWeights[d] /= domSum; });

  // Normalise capability weights within each domain
  const capWeights = {};
  domainNames.forEach(d => { capWeights[d] = []; });
  capabilities.forEach((cap, idx) => { capWeights[cap.domain].push(selections[idx].weight); });
  domainNames.forEach(d => {
    const s = capWeights[d].reduce((a, b) => a + b, 0) || 1;
    capWeights[d] = capWeights[d].map(w => w / s);
  });

  // Compute domain scores
  const domainScores = {}, domainAverages = {};
  const domainIndexStart = {};
  let start = 0;
  domainNames.forEach(d => { domainIndexStart[d] = start; start += domainsData[d].length; });

  domainNames.forEach(d => {
    const caps = domainsData[d];
    let wSum = 0, sSum = 0;
    caps.forEach((cap, j) => {
      const gi = domainIndexStart[d] + j;
      wSum += selections[gi].level * capWeights[d][j];
      sSum += selections[gi].level;
    });
    domainScores[d] = wSum;
    domainAverages[d] = sSum / caps.length;
  });

  let overallWeighted = 0, overallSimple = 0;
  domainNames.forEach(d => {
    overallWeighted += domainScores[d] * domWeights[d];
    overallSimple   += domainAverages[d];
  });
  overallSimple /= domainNames.length;

  const overallLabel = getMaturityLabel(overallWeighted);

  // ── Overall stat cards
  document.getElementById('results-stats').innerHTML = `
    <div class="stat-card">
      <div class="stat-icon">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </div>
      <div class="stat-label">Weighted Score</div>
      <div class="stat-value">${overallWeighted.toFixed(2)}</div>
      <div class="stat-sub">out of 5.00</div>
    </div>
    <div class="stat-card">
      <div class="stat-icon">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><line x1="18" y1="20" x2="18" y2="10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><line x1="12" y1="20" x2="12" y2="4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><line x1="6" y1="20" x2="6" y2="14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
      </div>
      <div class="stat-label">Simple Average</div>
      <div class="stat-value">${overallSimple.toFixed(2)}</div>
      <div class="stat-sub">out of 5.00</div>
    </div>
    <div class="stat-card">
      <div class="stat-icon">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </div>
      <div class="stat-label">Overall Maturity</div>
      <div class="stat-value" style="font-size:18px;padding-top:4px"><span class="badge ${overallLabel.cls}">${overallLabel.label}</span></div>
      <div class="stat-sub">${domainNames.length} domains assessed</div>
    </div>
  `;

  // ── Results table body
  const tbody = document.getElementById('results-tbody');
  tbody.innerHTML = '';
  domainNames.forEach(d => {
    const score = domainScores[d];
    const avg   = domainAverages[d];
    const pct   = (score / 5) * 100;
    const ml    = getMaturityLabel(score);
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td style="font-weight:500">${d}</td>
      <td><span class="badge ${ml.cls}">${ml.label}</span></td>
      <td>
        <div class="score-cell">
          <div class="score-bar"><div class="score-bar-fill" style="width:${pct}%"></div></div>
          <span class="score-num">${score.toFixed(2)}</span>
        </div>
      </td>
      <td>${avg.toFixed(2)}</td>
    `;
    tbody.appendChild(tr);
  });

  // ── Results table footer
  const overallPct = (overallWeighted / 5) * 100;
  document.getElementById('results-tfoot-row').innerHTML = `
    <td>Overall</td>
    <td><span class="badge ${overallLabel.cls}">${overallLabel.label}</span></td>
    <td>
      <div class="score-cell">
        <div class="score-bar"><div class="score-bar-fill" style="width:${overallPct}%"></div></div>
        <span class="score-num">${overallWeighted.toFixed(2)}</span>
      </div>
    </td>
    <td>${overallSimple.toFixed(2)}</td>
  `;

  // ── Bar chart
  const ctx = document.getElementById('scoreChart').getContext('2d');
  if (window._scoreChart) window._scoreChart.destroy();
  const labels   = domainNames.map(d => d.split(' ').map(w => w[0]).join(''));
  const chartData = domainNames.map(d => parseFloat(domainScores[d].toFixed(2)));
  window._scoreChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels,
      datasets: [{
        label: 'Weighted Score',
        data: chartData,
        backgroundColor: '#FFAA72',
        borderColor: '#FD5108',
        borderWidth: 2,
        borderRadius: 4
      }]
    },
    options: {
      scales: {
        y: { beginAtZero: true, max: 5, grid: { color: '#EEEFF1' }, ticks: { font: { size: 11 } } },
        x: { ticks: { font: { size: 11 } } }
      },
      plugins: {
        legend: { display: false },
        tooltip: { callbacks: { title: (items) => domainNames[items[0].dataIndex] } }
      },
      animation: { duration: 600 }
    }
  });
}

// ── INIT ──────────────────────────────────────────────────
buildDomainGrid();
loadSavedProgress();
showStep();
</script>
</body>
</html>
