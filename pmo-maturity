<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PMO Maturity Assessment — PwC</title>
<style>
/* ── DESIGN TOKENS ── */
:root {
  --o500: #FD5108;
  --o300: #FFAA72;
  --o100: #FFE8D4;
  --black: #000;
  --white: #fff;
  --g100: #EEEFF1;
  --g200: #DFE3E6;
  --g300: #CBD1D6;
  --g400: #B5BCC4;
  --g500: #A1A8B3;
  --success: #22C55E; --successBg: #DCFCE7;
  --warning: #EAB308; --warningBg: #FEF3C7;
  --error: #EF4444;   --errorBg: #FEE2E2;
  --info: #3B82F6;    --infoBg: #DBEAFE;
  --radius: 6px;
  --shadow: 0 1px 3px rgba(0,0,0,.08), 0 4px 16px rgba(0,0,0,.06);
  --shadow-md: 0 4px 24px rgba(0,0,0,.12);
}
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }
body {
  font-family: system-ui, -apple-system, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  background: var(--g100);
  color: var(--black);
  min-height: 100vh;
}
.hidden { display: none !important; }

/* ── TOP BAR ── */
.topbar {
  background: var(--white);
  border-bottom: 1px solid var(--g200);
  height: 56px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 32px;
  position: sticky;
  top: 0;
  z-index: 100;
  box-shadow: var(--shadow);
}
.topbar-left { display: flex; align-items: center; gap: 16px; }
.topbar-divider { width: 1px; height: 24px; background: var(--g200); flex-shrink: 0; }
.topbar-title { font-size: 14px; font-weight: 600; color: var(--black); }
.topbar-actions { display: flex; align-items: center; gap: 8px; }

/* ── BUTTONS ── */
.btn {
  display: inline-flex; align-items: center; justify-content: center; gap: 6px;
  font-family: inherit; font-weight: 600; font-size: 13px; cursor: pointer;
  border: none; border-radius: var(--radius); transition: all 0.15s ease;
  white-space: nowrap; padding: 8px 18px; line-height: 1;
}
.btn:focus-visible { outline: 2px solid var(--o500); outline-offset: 2px; }
.btn-primary { background: var(--o300); color: var(--black); border: 1px solid var(--o300); }
.btn-primary:hover { background: #f09a5e; border-color: #f09a5e; }
.btn-secondary { background: transparent; color: var(--black); border: 1px solid var(--black); }
.btn-secondary:hover { background: var(--g100); }
.btn-ghost { background: transparent; color: var(--g500); border: 1px solid var(--g200); }
.btn-ghost:hover { color: var(--black); border-color: var(--g400); background: var(--g100); }
.btn-sm { padding: 5px 12px; font-size: 12px; }
.btn:disabled, .btn.disabled { opacity: 0.5; cursor: not-allowed; pointer-events: none; }

/* ── PAGE LAYOUT ── */
.page { max-width: 1280px; margin: 0 auto; padding: 20px 24px 48px; }

/* ── PROGRESS SECTION ── */
.progress-section {
  background: var(--white);
  border: 1px solid var(--g200);
  border-radius: var(--radius);
  padding: 12px 20px;
  margin-bottom: 16px;
  box-shadow: var(--shadow);
}
.progress-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
.step-label { font-size: 13px; font-weight: 600; color: var(--black); }
.step-count { font-size: 12px; color: var(--g400); font-weight: 500; }
.progress-track { width: 100%; height: 5px; background: var(--g200); border-radius: 3px; overflow: hidden; }
.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--o500) 0%, var(--o300) 100%);
  border-radius: 3px;
  transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  width: 0%;
}

/* ── STEP CARD ── */
.step-card {
  background: var(--white);
  border: 1px solid var(--g200);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  overflow: hidden;
  animation: fadeIn 0.2s ease;
}
.step-card-header {
  padding: 16px 24px;
  border-bottom: 1px solid var(--g200);
  background: var(--white);
}
.step-card-title { font-size: 18px; font-weight: 700; color: var(--black); margin-bottom: 4px; }
.step-card-desc { font-size: 13px; color: var(--g500); max-width: 680px; }
.step-card-body { padding: 20px 24px; }
.step-card-footer {
  padding: 14px 24px;
  border-top: 1px solid var(--g200);
  background: var(--g100);
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
}

/* ── DOMAIN WEIGHTING ── */
.domain-grid { display: flex; flex-direction: column; gap: 8px; }
.domain-item {
  display: flex; align-items: center; gap: 14px;
  padding: 12px 16px;
  border: 1px solid var(--g200);
  border-radius: var(--radius);
  background: var(--white);
  transition: border-color 0.15s;
}
.domain-item:hover { border-color: var(--o300); }
.domain-item-icon {
  width: 30px; height: 30px; border-radius: 50%;
  background: var(--o100);
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0;
  font-size: 11px; font-weight: 700; color: var(--o500);
}
.domain-item-name { flex: 1; font-size: 13px; font-weight: 500; color: var(--black); }
.domain-item-count { font-size: 11px; color: var(--g400); white-space: nowrap; }
.domain-weight-input {
  width: 64px; padding: 6px 8px;
  border: 1px solid var(--g200); border-radius: var(--radius);
  font-size: 12px; font-family: inherit;
  background: var(--white); color: var(--black);
  text-align: center; transition: border-color 0.15s;
}
.domain-weight-input:focus { outline: none; border-color: var(--o500); box-shadow: 0 0 0 3px rgba(253,81,8,.1); }
.weight-unit { font-size: 11px; color: var(--g400); }

/* ── CAPABILITY ASSESSMENT HEADER ── */
.capability-header {
  display: flex;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
}
.domain-badge {
  display: inline-flex; align-items: center;
  padding: 3px 10px;
  background: var(--o100); color: var(--o500);
  font-size: 11px; font-weight: 700;
  border-radius: 20px;
  text-transform: uppercase; letter-spacing: 0.06em;
  white-space: nowrap;
}
.capability-title { font-size: 16px; font-weight: 700; color: var(--black); }
.capability-meta { font-size: 12px; color: var(--g400); margin-left: auto; white-space: nowrap; }

/* ── MATURITY LEVEL CARDS (horizontal grid) ── */
.maturity-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 10px;
}
.maturity-card {
  display: flex;
  flex-direction: column;
  border: 2px solid var(--g200);
  border-radius: var(--radius);
  cursor: pointer;
  transition: all 0.15s ease;
  background: var(--white);
  user-select: none;
  overflow: hidden;
  position: relative;
}
.maturity-card:hover { border-color: var(--o300); background: #fefaf8; }
.maturity-card.selected { border-color: var(--o500); background: var(--o100); }
.maturity-card:focus-visible { outline: 2px solid var(--o500); outline-offset: 2px; }
.maturity-card-accent { height: 3px; width: 100%; flex-shrink: 0; }
.maturity-card-header {
  padding: 10px 14px 4px;
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--g400);
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.maturity-card.selected .maturity-card-header { color: var(--o500); }
.maturity-card-check {
  width: 16px; height: 16px; border-radius: 50%;
  border: 2px solid var(--g300);
  display: flex; align-items: center; justify-content: center;
  transition: all 0.15s; flex-shrink: 0;
}
.maturity-card.selected .maturity-card-check {
  background: var(--o500); border-color: var(--o500);
}
.maturity-card-check svg { display: none; }
.maturity-card.selected .maturity-card-check svg { display: block; }
.maturity-card-desc {
  padding: 0 14px 14px;
  font-size: 12.5px;
  line-height: 1.55;
  color: var(--black);
  flex: 1;
}
.maturity-card.selected .maturity-card-desc { color: #4a1e00; }

/* Level accent colours */
.maturity-card.lvl-1 .maturity-card-accent { background: var(--g400); }
.maturity-card.lvl-2 .maturity-card-accent { background: var(--warning); }
.maturity-card.lvl-3 .maturity-card-accent { background: var(--info); }
.maturity-card.lvl-4 .maturity-card-accent { background: var(--success); }
.maturity-card.lvl-5 .maturity-card-accent { background: var(--o500); }

/* ── BADGES ── */
.badge { display: inline-flex; align-items: center; padding: 3px 10px; font-size: 11px; font-weight: 600; white-space: nowrap; border-radius: 20px; }
.badge-initial    { background: var(--errorBg);   color: var(--error);   }
.badge-developing { background: var(--warningBg); color: #92680a;        }
.badge-defined    { background: var(--infoBg);    color: #1d5eaa;        }
.badge-managed    { background: var(--successBg); color: #166534;        }
.badge-optimising { background: var(--o100);      color: var(--o500);    }

/* ── RESULTS: HERO ── */
.results-hero {
  text-align: center;
  padding: 28px 20px;
  margin-bottom: 24px;
  background: linear-gradient(135deg, var(--white) 0%, var(--o100) 100%);
  border: 1px solid var(--g200);
  border-radius: var(--radius);
}
.results-hero-score {
  font-size: 56px;
  font-weight: 800;
  color: var(--black);
  line-height: 1;
  margin-bottom: 4px;
}
.results-hero-max { font-size: 18px; color: var(--g400); font-weight: 400; }
.results-hero-label { margin-top: 12px; }
.results-hero-sub { font-size: 13px; color: var(--g500); margin-top: 8px; }

/* ── RESULTS: STAT CARDS ── */
.results-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 24px; }
.stat-card {
  padding: 16px; border: 1px solid var(--g200);
  border-radius: var(--radius); background: var(--white);
  text-align: center;
}
.stat-label { font-size: 11px; font-weight: 700; color: var(--g500); text-transform: uppercase; letter-spacing: 0.06em; margin-bottom: 4px; }
.stat-value { font-size: 22px; font-weight: 700; color: var(--black); line-height: 1.2; }
.stat-sub { font-size: 11px; color: var(--g400); margin-top: 2px; }

/* ── RESULTS: DOMAIN SCORE CARDS ── */
.domain-scores-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
  margin-bottom: 24px;
}
.domain-score-card {
  padding: 16px;
  border: 1px solid var(--g200);
  border-radius: var(--radius);
  background: var(--white);
  border-left: 4px solid var(--g300);
  transition: border-color 0.15s;
}
.domain-score-card-name { font-size: 12px; font-weight: 600; color: var(--black); margin-bottom: 8px; line-height: 1.3; }
.domain-score-card-row { display: flex; align-items: center; gap: 10px; margin-bottom: 6px; }
.domain-score-card-num { font-size: 22px; font-weight: 700; color: var(--black); min-width: 48px; }
.score-bar-wrap { flex: 1; }
.score-bar { height: 6px; background: var(--g200); border-radius: 3px; overflow: hidden; }
.score-bar-fill { height: 100%; border-radius: 3px; transition: width 0.6s ease; }

/* Domain card border colours */
.domain-score-card[data-maturity="initial"]    { border-left-color: var(--error); }
.domain-score-card[data-maturity="developing"] { border-left-color: var(--warning); }
.domain-score-card[data-maturity="defined"]    { border-left-color: var(--info); }
.domain-score-card[data-maturity="managed"]    { border-left-color: var(--success); }
.domain-score-card[data-maturity="optimising"] { border-left-color: var(--o500); }

/* Score bar fill colours by maturity */
.score-fill-initial    { background: var(--error); }
.score-fill-developing { background: var(--warning); }
.score-fill-defined    { background: var(--info); }
.score-fill-managed    { background: var(--success); }
.score-fill-optimising { background: var(--o500); }

/* ── RESULTS: CHART ── */
.chart-wrap {
  background: var(--white); border: 1px solid var(--g200);
  border-radius: var(--radius); padding: 20px; margin-bottom: 24px;
}
.chart-heading { font-size: 12px; font-weight: 700; color: var(--g500); text-transform: uppercase; letter-spacing: 0.06em; margin-bottom: 12px; }

/* ── RESULTS: SECTION HEADERS ── */
.section-header {
  font-size: 16px;
  font-weight: 700;
  color: var(--black);
  margin-bottom: 16px;
  padding-bottom: 8px;
  border-bottom: 2px solid var(--o500);
  display: inline-block;
}

/* ── RECOMMENDATIONS ── */
.rec-priority-group { margin-bottom: 24px; }
.rec-priority-label {
  display: flex; align-items: center; gap: 8px;
  font-size: 12px; font-weight: 700; text-transform: uppercase;
  letter-spacing: 0.06em; margin-bottom: 10px; color: var(--g500);
}
.rec-priority-dot {
  width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0;
}
.rec-cards { display: flex; flex-direction: column; gap: 8px; }
.rec-card {
  padding: 14px 18px;
  background: var(--white);
  border: 1px solid var(--g200);
  border-radius: var(--radius);
  border-left: 4px solid var(--g300);
}
.rec-card-critical { border-left-color: var(--error); }
.rec-card-improvement { border-left-color: var(--info); }
.rec-card-finetune { border-left-color: var(--success); }
.rec-card-top {
  display: flex; align-items: center; justify-content: space-between;
  gap: 8px; margin-bottom: 6px; flex-wrap: wrap;
}
.rec-card-cap { font-size: 13px; font-weight: 700; color: var(--black); }
.rec-card-levels {
  display: flex; align-items: center; gap: 4px;
  font-size: 11px; font-weight: 600;
}
.rec-card-level-badge {
  padding: 2px 8px; border-radius: 10px; font-size: 11px; font-weight: 700;
}
.rec-card-arrow { color: var(--g400); font-size: 10px; }
.rec-card-domain { font-size: 11px; color: var(--g500); margin-bottom: 4px; }
.rec-card-text { font-size: 13px; color: #333; line-height: 1.55; }

/* ── STRENGTHS ── */
.strengths-section { margin-top: 8px; }
.strengths-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
}
.strength-chip {
  padding: 10px 14px;
  background: var(--successBg);
  border: 1px solid #bbf7d0;
  border-radius: var(--radius);
  font-size: 12px;
  font-weight: 500;
  color: #166534;
  display: flex;
  align-items: center;
  gap: 6px;
}
.strength-chip svg { flex-shrink: 0; }

/* ── ANIMATIONS ── */
@keyframes fadeIn { from { opacity: 0; transform: translateY(4px); } to { opacity: 1; transform: translateY(0); } }

/* ── RESPONSIVE ── */
@media (max-width: 1024px) {
  .maturity-grid { grid-template-columns: repeat(3, 1fr); }
  .domain-scores-grid { grid-template-columns: repeat(2, 1fr); }
  .strengths-grid { grid-template-columns: repeat(2, 1fr); }
}
@media (max-width: 640px) {
  .topbar { padding: 0 16px; }
  .topbar-title { display: none; }
  .page { padding: 12px 12px 32px; }
  .step-card-header, .step-card-body, .step-card-footer { padding-left: 16px; padding-right: 16px; }
  .maturity-grid { grid-template-columns: repeat(2, 1fr); }
  .domain-scores-grid { grid-template-columns: 1fr; }
  .results-stats { grid-template-columns: 1fr; }
  .strengths-grid { grid-template-columns: 1fr; }
  .capability-header { flex-direction: column; align-items: flex-start; gap: 4px; }
  .capability-meta { margin-left: 0; }
}
@media print {
  .topbar, .step-card-footer, .progress-section { display: none; }
  .page { max-width: 100%; padding: 0; }
  .step-card { box-shadow: none; border: none; }
}
</style>
</head>
<body>

<!-- ── TOP BAR ── -->
<header class="topbar">
  <div class="topbar-left">
    <a href="#" style="display:flex;align-items:center;text-decoration:none;flex-shrink:0" aria-label="PwC">
      <svg width="72" height="34" viewBox="30 143 440 212" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M355.041 233.765C339.717 236.206 331.925 247.425 331.925 267.214C331.925 287.003 342.331 300.403 358.334 300.403C365.762 300.403 372.508 297.962 386.732 291.054V307.155C369.682 314.894 359.642 317.335 345.94 317.335C331.088 317.335 320.629 313.44 312.052 304.766C303.319 296.092 298.926 284.561 298.926 271.784C298.926 243.322 320.158 224.104 351.118 224.104C371.67 224.104 385.842 233.453 385.842 247.165C385.842 255.995 379.252 262.072 369.473 262.072C364.454 262.072 360.323 260.773 355.041 257.709V233.869V233.765ZM279.472 271.732C293.173 254.54 298.037 247.632 298.037 239.166C298.037 230.7 291.343 224 282.348 224C276.805 224 271.837 226.597 269.431 229.298V264.305L246.944 294.066V226.234H225.555L190.045 284.717V226.234H177.756L145.489 234.024V242.231L163.061 243.997V315.725H185.809L219.907 260.098V315.725H244.8L279.42 271.732H279.472ZM77.6086 244.464C82.8381 243.841 85.4532 243.529 87.9111 243.529C102.763 243.529 110.764 253.294 110.764 271.732C110.764 293.495 100.933 304.818 82.6291 304.818C81.1125 304.818 80.0143 304.818 77.6086 304.714V244.464ZM77.6086 314.894C83.518 315.569 89.2708 315.777 92.7223 315.777C123.211 315.777 142.508 296.404 142.508 267.629C142.508 242.75 128.022 224.727 108.359 224.727C99.8346 224.727 94.1867 226.441 77.6086 236.258V224.26H68.4046L33 234.959V243.581H47.6429V343.928L34.4643 347.2V355.511H92.304V347.2L77.5564 343.928V314.894H77.6086Z" fill="#000"/>
        <path d="M338.568 199.173H242.029L258.45 172.112H354.99L338.568 199.173ZM468 145H371.463L355.042 172.06H451.579L468 145Z" fill="#FD5108"/>
      </svg>
    </a>
    <div class="topbar-divider"></div>
    <span class="topbar-title">PMO Maturity Assessment</span>
  </div>
  <div class="topbar-actions">
    <button id="save-btn" class="btn btn-ghost btn-sm">
      <svg width="12" height="12" viewBox="0 0 16 16" fill="none"><path d="M13 2H4.5L2 4.5V13a1 1 0 001 1h10a1 1 0 001-1V3a1 1 0 00-1-1z" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/><path d="M5.5 2v3.5h5V2M4.5 10h7v4h-7z" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/></svg>
      Save
    </button>
    <button id="reset-btn" class="btn btn-ghost btn-sm">
      <svg width="12" height="12" viewBox="0 0 16 16" fill="none"><path d="M13.5 8A5.5 5.5 0 112.5 8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M2.5 4v4h4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
      Reset
    </button>
  </div>
</header>

<!-- ── MAIN ── -->
<main class="page">

  <!-- PROGRESS BAR -->
  <div class="progress-section">
    <div class="progress-header">
      <span class="step-label" id="step-label">Domain Weighting</span>
      <span class="step-count" id="step-count"></span>
    </div>
    <div class="progress-track">
      <div class="progress-fill" id="progress-bar"></div>
    </div>
  </div>

  <!-- STEP 0: DOMAIN WEIGHTING -->
  <div id="domain-step" class="step-card">
    <div class="step-card-header">
      <div class="step-card-title">Domain Weighting</div>
      <div class="step-card-desc">Assign relative importance to each domain. Values are normalised automatically — higher numbers indicate greater priority.</div>
    </div>
    <div class="step-card-body">
      <div class="domain-grid" id="domain-grid"></div>
    </div>
    <div class="step-card-footer">
      <span></span>
      <button id="domain-next" class="btn btn-primary">
        Begin Assessment
        <svg width="13" height="13" viewBox="0 0 16 16" fill="none"><path d="M3 8h10M9 4l4 4-4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </button>
    </div>
  </div>

  <!-- STEP 1–N: CAPABILITY ASSESSMENT -->
  <div id="capability-step" class="step-card hidden">
    <div class="step-card-header">
      <div class="capability-header">
        <div class="domain-badge" id="cap-domain-badge">Domain</div>
        <div class="capability-title" id="cap-name">Capability</div>
        <div class="capability-meta" id="cap-meta"></div>
      </div>
    </div>
    <div class="step-card-body">
      <div class="maturity-grid" id="maturity-grid"></div>
    </div>
    <div class="step-card-footer">
      <button id="prev-btn" class="btn btn-secondary">
        <svg width="13" height="13" viewBox="0 0 16 16" fill="none"><path d="M13 8H3M7 4L3 8l4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        Previous
      </button>
      <button id="next-btn" class="btn btn-primary">
        Next
        <svg width="13" height="13" viewBox="0 0 16 16" fill="none"><path d="M3 8h10M9 4l4 4-4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </button>
    </div>
  </div>

  <!-- STEP N+1: RESULTS -->
  <div id="results-step" class="step-card hidden">
    <div class="step-card-header">
      <div class="step-card-title">Assessment Results</div>
      <div class="step-card-desc">Your PMO maturity profile across all domains, weighted by your inputs.</div>
    </div>
    <div class="step-card-body" id="results-body"></div>
    <div class="step-card-footer">
      <button id="results-prev-btn" class="btn btn-secondary">
        <svg width="13" height="13" viewBox="0 0 16 16" fill="none"><path d="M13 8H3M7 4L3 8l4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        Back to Assessment
      </button>
      <button onclick="window.print()" class="btn btn-primary">
        <svg width="13" height="13" viewBox="0 0 16 16" fill="none"><path d="M4 6V2h8v4M2 6h12v6H2V6zM5 11h6M5 9h4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
        Print / Export
      </button>
    </div>
  </div>

</main>

  <script type="application/json" id="domains-data">
{"Data, Reporting & Insights": [{"name": "Data integrity & governance", "levels": ["Portfolio data is fragmented across tools and spreadsheets with no defined ownership, leading to inconsistent and unreliable information.", "Some data consolidation exists but ownership is patchy and reconciliation across sources is inconsistent, limiting trust in reporting.", "A central data repository is established with defined stewardship roles, standards, and accountability for data accuracy and timeliness.", "Data governance controls ensure accuracy and timeliness, with accountable owners monitoring quality metrics and driving remediation.", "An integrated data ecosystem with mature governance provides reliable, near-real-time portfolio data with continuous quality improvement."]}, {"name": "Data quality & reporting automation", "levels": ["Data quality is unchecked and reporting is entirely manual, making outputs slow, error-prone, and difficult to trust.", "Basic validation exists for some data and some reports are partially automated, but coverage and consistency are limited.", "Defined data quality rules are applied systematically and key reports are automated with consistent schedules and formats.", "Automated quality monitoring flags anomalies proactively, and most reporting is automated with exception-based manual intervention.", "Continuous data quality improvement is embedded, and fully automated reporting pipelines deliver real-time, trusted outputs."]}, {"name": "KPI & executive dashboards", "levels": ["KPIs are undefined and executive reporting is manual and static, so decisions lack data-driven foundation.", "Some KPIs exist but definitions vary, and basic dashboards have quality issues that reduce executive confidence.", "A standard KPI framework is defined and interactive dashboards present consistent measures for executive governance.", "KPIs drive governance decisions and dashboards integrate value, risk, capacity, and dependencies for exception-focused management.", "Predictive KPIs and advanced analytics provide early warning and portfolio optimisation insights to executives."]}, {"name": "Insight-driven decision support", "levels": ["Decisions are largely intuition-based, and reporting is used mainly for retrospective status updates.", "Reports inform discussions, but decisions are not consistently driven by data and structured analysis.", "Insights are routinely presented in governance forums, and decisions reference agreed measures and supporting evidence.", "Data is used to evaluate trade-offs, allocate resources, and manage risks with transparency and accountability.", "Advanced analytics provide optimisation recommendations, and decision outcomes are measured and refined over time."]}], "Delivery Frameworks & Ways of Working": [{"name": "Delivery methodology & integration", "levels": ["Delivery approaches vary widely with no common framework, and agile and waterfall operate in silos without aligned governance.", "A delivery framework exists but adoption is uneven, and integration between agile and predictive methods is inconsistent.", "A standard methodology supports agile, predictive, and hybrid delivery with comparable controls, templates, and reporting.", "The methodology is embedded in governance and tooling, enabling consistent assurance across delivery types with performance data driving refinement.", "The methodology is continuously improved using cross-delivery-type insights, and new approaches are adopted with governance built in from the start."]}, {"name": "Schedule & scope control", "levels": ["Schedules are unreliable and scope changes are frequent and uncontrolled, with no consistent forecasting or change discipline.", "Basic scheduling exists but forecasting is weak, and scope changes are sometimes documented but not rigorously managed.", "Schedules use defined methods with dependencies and milestones, and scope changes follow a controlled change process.", "Forecasting uses trend data and earned-value techniques, and scope control is enforced through governance with impact assessment.", "Predictive scheduling and proactive scope management optimise delivery outcomes with continuous lessons-learned integration."]}, {"name": "Delivery risk & change management", "levels": ["Delivery risks are managed reactively and change impacts are not assessed, leading to surprises and rework.", "Risks are identified on some initiatives but not consistently managed, and change impact assessment is ad hoc.", "A standard risk framework is applied to all deliveries, and change management processes assess impact on people, process, and technology.", "Risk quantification and change readiness assessments are embedded in governance, enabling proactive intervention and mitigation.", "Integrated risk and change management drive predictive delivery outcomes, with continuous improvement from lessons learned."]}, {"name": "Lessons learned & continuous improvement", "levels": ["Lessons learned are not captured, and the same mistakes recur across initiatives without organisational learning.", "Lessons are captured sporadically but not shared or applied, limiting their value for future delivery improvement.", "A structured lessons-learned process is defined with regular capture, sharing across teams, and integration into methodology updates.", "Lessons drive measurable improvements to delivery practices, and their impact on outcomes is tracked and reported.", "A learning culture is embedded where teams proactively share insights and the organisation continuously adapts its delivery practices."]}], "Demand & Investment Governance": [{"name": "Demand intake & prioritisation", "levels": ["Demand arrives through informal channels with no consistent intake process, and prioritisation is ad hoc and politically driven.", "A basic intake process exists but not all demand flows through it, and prioritisation criteria are applied inconsistently.", "A standard intake process captures all demand with defined criteria, and prioritisation uses consistent, transparent methods.", "Intake and prioritisation are integrated with capacity and strategy, enabling trade-off decisions with clear rationale.", "Dynamic demand management and real-time prioritisation optimise the portfolio continuously based on value, risk, and capacity signals."]}, {"name": "Business case & investment approval", "levels": ["Business cases are weak or absent, and investment decisions lack rigour, transparency, and consistent approval criteria.", "Business cases are produced for major initiatives but quality varies, and approval processes are not consistently followed.", "Business cases follow a defined template with required elements, and approval governance applies consistent evaluation criteria.", "Business cases are stress-tested with sensitivity analysis, and approval governance considers portfolio-level trade-offs and strategic fit.", "Investment decisions are optimised through sophisticated analysis, and business case performance is tracked post-approval to validate assumptions."]}, {"name": "Funding & stage gate governance", "levels": ["Funding is opaque and stage gates are absent or ceremonial, providing no meaningful control over investment progression.", "Funding visibility is limited and stage gate reviews exist but are not consistently enforced or used to make stop/go decisions.", "Funding is transparent with clear allocation and tracking, and stage gates enforce evidence-based progression decisions.", "Funding and stage gate governance are integrated, enabling reallocation based on performance and shifting priorities.", "Funding governance is dynamic with real-time visibility, and stage gates continuously validate value realisation and strategic alignment."]}, {"name": "Decision rights clarity", "levels": ["Decision rights are undefined, leading to confusion about who can approve, escalate, or stop initiatives.", "Decision rights are partially documented but not consistently understood or applied across governance forums.", "Decision rights are defined in a governance framework with clear escalation paths, thresholds, and accountability.", "Decision rights are embedded in tools and processes, ensuring timely decisions with appropriate authority and transparency.", "Decision governance is continuously refined based on performance data, and decision quality is measured and improved."]}], "Financial Management & Benefits": [{"name": "Financial forecasting & variance", "levels": ["Cost forecasts are unreliable and variances are not tracked, leaving the portfolio exposed to budget overruns without early warning.", "Basic forecasting exists but accuracy is low, and variance analysis is reactive and inconsistently applied across initiatives.", "Forecasting uses defined methods with regular updates, and variance analysis follows a standard process with thresholds and escalation.", "Forecasting incorporates trend analysis and risk adjustments, and variance management drives corrective action through governance.", "Predictive financial modelling and automated variance detection enable proactive portfolio financial management and optimisation."]}, {"name": "Budget & financial governance", "levels": ["Budget controls are weak and expenditure categorisation is unclear, resulting in poor financial discipline and accountability.", "Basic budget tracking exists but controls are inconsistent, and capital versus operating expenditure treatment varies across initiatives.", "Budget governance is defined with clear controls, approval thresholds, and consistent expenditure categorisation including capex/opex.", "Budget management is integrated with portfolio governance, and financial controls ensure discipline with clear accountability.", "Financial governance is mature with automated controls, real-time budget visibility, and continuous improvement of financial processes."]}, {"name": "Benefits realisation & reporting", "levels": ["Benefits are not tracked after approval, and there is no visibility into whether investments are delivering expected value.", "Benefits are tracked for some initiatives but measurement is inconsistent and investment performance reporting is limited.", "Benefits realisation follows a defined process with owners, measures, and regular reporting integrated into governance.", "Benefits performance drives portfolio decisions, and investment reporting provides clear accountability for value delivery.", "Benefits realisation is optimised with predictive analytics, and a continuous feedback loop ensures investments maximise value."]}, {"name": "Post-implementation review", "levels": ["Post-implementation reviews are not conducted, so the organisation does not learn from completed investments.", "Reviews occur sporadically and findings are not shared or acted upon in a structured way.", "A standard review process is defined with consistent criteria, and findings are shared with relevant stakeholders.", "Review insights are integrated into governance and planning, improving business case quality and delivery practices.", "Post-implementation learning is embedded in the investment lifecycle, with outcomes continuously improving decision-making."]}], "PMO Structure, Mandate & Value": [{"name": "PMO mandate & strategic influence", "levels": ["The PMO has no formal mandate and operates reactively with limited visibility or influence over strategic decisions.", "A basic mandate exists but the PMO is seen primarily as administrative, with limited engagement in strategic discussions.", "The PMO has a defined mandate aligned to organisational objectives, and leadership recognises its role in portfolio governance.", "The PMO actively shapes portfolio decisions with a seat at the strategy table, influencing investment and prioritisation outcomes.", "The PMO is a strategic partner that drives portfolio optimisation, with a mandate that evolves alongside organisational strategy."]}, {"name": "Service catalogue & governance model", "levels": ["PMO services are undefined and governance structures are informal, leading to inconsistent support and unclear expectations.", "Some PMO services are recognised but not formally catalogued, and governance structures exist but are not consistently applied.", "A service catalogue defines PMO offerings with clear scope, and a governance model establishes forums, cadences, and accountabilities.", "PMO services and governance are integrated with organisational processes, with feedback loops driving service improvement.", "The service catalogue and governance model are continuously refined based on stakeholder needs and organisational maturity."]}, {"name": "PMO performance & stakeholder measurement", "levels": ["PMO performance is not measured and stakeholder satisfaction is unknown, making it difficult to demonstrate value.", "Basic activity metrics are tracked but there is no structured approach to measuring PMO outcomes or stakeholder satisfaction.", "PMO performance is measured using defined KPIs, and stakeholder satisfaction is regularly assessed with feedback acted upon.", "Performance measurement drives PMO improvement, and stakeholder insights shape service priorities and governance focus.", "The PMO demonstrates measurable value through outcome-based metrics, and stakeholder engagement drives continuous evolution."]}, {"name": "Continuous improvement discipline", "levels": ["There is no structured approach to improving PMO practices, and changes are reactive rather than planned.", "Some improvement initiatives exist but they are not systematic or tracked for impact.", "A continuous improvement framework is defined with regular reviews, improvement backlog, and assigned ownership.", "Improvement initiatives are prioritised by impact, tracked to completion, and outcomes are measured and reported.", "Continuous improvement is embedded in PMO culture, with innovation encouraged and improvement outcomes driving strategic value."]}], "Portfolio Planning & Optimisation": [{"name": "Capacity & resource alignment", "levels": ["Capacity planning is absent and resource allocation is reactive, resulting in chronic overcommitment and misalignment with demand.", "Basic capacity data exists but it is incomplete, and resource allocation does not consistently match prioritised demand.", "Capacity planning uses defined methods with regular updates, and resource allocation is aligned to prioritised portfolio demand.", "Capacity and demand are actively balanced through governance, with scenario analysis informing allocation trade-offs.", "Real-time capacity intelligence and dynamic allocation optimise resource utilisation and portfolio throughput continuously."]}, {"name": "Portfolio modelling & balance", "levels": ["Portfolio decisions are made without modelling alternatives, and the portfolio balance across risk, value, and timing is unmanaged.", "Basic portfolio views exist but scenario modelling is ad hoc, and balance considerations are informal and inconsistent.", "Scenario modelling supports portfolio decisions with what-if analysis, and portfolio balance is assessed across defined dimensions.", "Sophisticated modelling enables trade-off analysis across value, risk, capacity, and timing, informing governance decisions.", "Continuous portfolio optimisation uses advanced modelling and real-time data to maximise value and manage risk dynamically."]}, {"name": "Dependency & long-range planning", "levels": ["Dependencies are not tracked and planning is short-term only, leaving the portfolio vulnerable to cascading delays and strategic drift.", "Some dependencies are identified but not actively managed, and long-range planning is limited to individual initiatives.", "Dependencies are mapped and managed at the portfolio level, and long-range planning integrates with strategic and financial cycles.", "Dependency management is proactive with impact analysis, and long-range planning informs annual budgets and capacity decisions.", "Integrated dependency and long-range planning provides end-to-end visibility, enabling strategic agility and proactive risk management."]}, {"name": "Reprioritisation responsiveness", "levels": ["The portfolio cannot respond to changing priorities, and reprioritisation is slow, political, and lacks clear criteria.", "Reprioritisation occurs but is reactive and inconsistent, with limited data to support trade-off decisions.", "A defined reprioritisation process enables timely response to change, using agreed criteria and governance authority.", "Reprioritisation is data-driven and integrated with capacity and financial governance, enabling rapid portfolio adjustments.", "The portfolio is continuously optimised with real-time signals triggering proactive reprioritisation aligned to strategic outcomes."]}], "Resource & Capability Management": [{"name": "Resource demand & capacity", "levels": ["Resource demand is unknown and capacity is unmanaged, resulting in overallocation, burnout, and delivery delays.", "Basic demand visibility exists but capacity data is incomplete, leading to reactive allocation and frequent conflicts.", "Resource demand and capacity are tracked using defined methods, enabling planned allocation aligned to portfolio priorities.", "Demand and capacity are actively balanced through governance, with optimisation driven by utilisation data and forecasting.", "Real-time demand and capacity intelligence enables dynamic optimisation, with predictive analytics improving resource outcomes."]}, {"name": "Skills & capability development", "levels": ["Skills data is not maintained and capability development is ad hoc, leaving gaps unidentified and unaddressed.", "Some skills information exists but it is incomplete, and development activities are not aligned to portfolio needs.", "Skills are mapped to roles and portfolio needs, and development programmes address identified capability gaps.", "Capability development is integrated with workforce and portfolio planning, with measurable improvement in skills outcomes.", "A learning organisation culture drives continuous capability development, with skills intelligence informing strategic resourcing."]}, {"name": "Role clarity & workforce planning", "levels": ["Roles are poorly defined and workforce planning is absent, leading to confusion about accountability and future resource needs.", "Some roles are documented but accountability overlaps exist, and workforce planning is limited to near-term needs.", "Roles are clearly defined with documented accountabilities, and workforce planning integrates with portfolio demand forecasts.", "Role design and workforce planning are aligned to strategic objectives, with succession and mobility actively managed.", "Workforce planning is a strategic capability that drives talent acquisition, development, and deployment for portfolio success."]}, {"name": "Vendor resource governance", "levels": ["Vendor resources are managed informally with no consistent oversight, quality standards, or performance accountability.", "Basic vendor management exists but performance monitoring is inconsistent and integration with internal teams is limited.", "Vendor governance is defined with clear performance expectations, onboarding standards, and regular review cadences.", "Vendor performance drives retention and allocation decisions, and vendor resources are integrated into capacity planning.", "Strategic vendor management optimises the blended workforce, with vendor capability continuously assessed and improved."]}], "Risk, Controls & Assurance": [{"name": "Enterprise risk & control framework", "levels": ["Portfolio risks are managed in isolation without enterprise alignment, and control frameworks are absent or informal.", "Some risk alignment exists but the control framework is incomplete, and integration with enterprise risk is inconsistent.", "A portfolio risk and control framework is defined and aligned to enterprise standards, with consistent application across initiatives.", "Risk quantification and control effectiveness are measured and reported to governance, enabling proactive risk management.", "The risk and control framework is continuously improved using data analytics, with portfolio and enterprise risk fully integrated."]}, {"name": "Assurance & compliance", "levels": ["Assurance reviews are absent and compliance is not tracked, leaving the portfolio exposed to unidentified control failures.", "Ad hoc assurance occurs but reviews are not structured, and compliance tracking is incomplete and inconsistent.", "Assurance reviews follow a defined framework with clear criteria, and compliance is tracked with traceability to requirements.", "Assurance findings drive governance action and compliance is proactively managed, with risk-based assurance prioritisation.", "Continuous assurance and compliance intelligence provide real-time visibility, with automated controls and exception management."]}, {"name": "Audit readiness & remediation", "levels": ["Audit readiness is poor and remediation of findings is unstructured, creating recurring control weaknesses.", "Some audit preparation occurs but documentation gaps exist, and remediation actions are tracked but not consistently closed.", "Audit readiness is maintained through structured documentation and controls, and remediation follows a defined process with ownership.", "Proactive audit preparation and disciplined remediation governance ensure findings are closed on time with root-cause analysis.", "Continuous audit readiness is embedded with automated controls, and remediation drives systemic improvement across the portfolio."]}, {"name": "Issue escalation clarity", "levels": ["Issue escalation paths are undefined, leading to delayed responses and unresolved blockers that derail delivery.", "Escalation occurs but processes are informal and inconsistent, resulting in variable response times and outcomes.", "Escalation paths are defined with clear criteria, thresholds, and response expectations documented in governance frameworks.", "Escalation is embedded in governance with tracking and accountability, ensuring timely resolution and transparent reporting.", "Escalation governance is continuously refined with metrics-driven improvement, and systemic issues trigger proactive intervention."]}], "Strategy & Portfolio Alignment": [{"name": "Strategic alignment & traceability", "levels": ["Investments are not linked to strategy, and there is no traceability from strategic objectives through to delivery activities.", "Some investments reference strategy but linkage is informal, and traceability from strategy to delivery is incomplete.", "Investments are mapped to strategic objectives with a scoring model, and traceability is maintained from strategy through to delivery.", "Strategic scoring informs prioritisation and funding, and end-to-end traceability enables impact analysis when strategy shifts.", "Continuous alignment recalibrates scoring and traceability when strategy evolves, ensuring the portfolio maximises strategic value."]}, {"name": "Portfolio objectives & review", "levels": ["Portfolio objectives are not defined and reviews do not occur, so delivery proceeds without shared direction or accountability.", "Informal objectives exist but are not consistently communicated, and portfolio reviews are irregular or unfocused.", "Portfolio objectives are formally defined with success criteria, and regular reviews assess progress against objectives.", "Reviews drive portfolio adjustments based on objective performance, with clear governance for course-correction decisions.", "Portfolio objectives and review cadences are dynamically aligned to strategy, with continuous improvement of governance effectiveness."]}, {"name": "Benefits & value measurement", "levels": ["Benefits are poorly defined and value is not measured, so the organisation cannot assess whether investments deliver outcomes.", "Benefits are defined for some investments but measurement is inconsistent and value tracking lacks rigour.", "Benefits are defined with clear owners, measures, and baselines, and value measurement follows a consistent methodology.", "Value measurement drives portfolio decisions, and benefits tracking is integrated with financial and strategic governance.", "Value measurement is optimised with predictive analytics, and a continuous feedback loop maximises portfolio value realisation."]}, {"name": "Executive sponsorship maturity", "levels": ["Executive sponsors are nominal or absent, providing no meaningful direction, decision-making, or barrier removal.", "Sponsors are assigned but engagement varies, and sponsor accountability for outcomes is not consistently enforced.", "Sponsor roles are defined with clear expectations, and sponsors are actively engaged in governance and key decisions.", "Sponsors are accountable for value delivery, with structured support including coaching and performance feedback.", "Executive sponsorship is a strategic capability, with sponsor effectiveness measured and continuously developed."]}]}
</script>

  <script type="application/json" id="recs-data">
{"Data, Reporting & Insights": {"Data integrity & governance": {"1": "Define the authoritative source for portfolio data, assign data stewardship roles, and establish basic standards for accuracy, timeliness, and ownership.", "2": "Consolidate key data elements into a central repository, apply stewardship routines, and reconcile definitions so reporting is consistent and trusted.", "3": "Embed data governance into decision-making, monitor quality metrics with accountable owners, and use automation to reduce manual errors.", "4": "Integrate data across systems, automate feeds, and continuously audit completeness to achieve reliable, near-real-time portfolio intelligence.", "5": "Sustain by refining governance standards, auditing stewardship effectiveness, and evolving the data ecosystem with organisational and system changes."}, "Data quality & reporting automation": {"1": "Define minimum data quality standards, implement basic validation checks, and identify high-effort manual reports for prioritised automation.", "2": "Standardise validation routines, automate core portfolio reports, and assign ownership for data defects so controls are consistently applied.", "3": "Monitor data quality metrics, integrate automated reporting into governance cadences, and manage remediation of recurring data issues.", "4": "Introduce anomaly detection, move towards near-real-time dashboards, and enable self-service analytics with controlled data standards.", "5": "Sustain by continuously improving automation coverage, auditing data quality outcomes, and refining pipelines as reporting needs evolve."}, "KPI & executive dashboards": {"1": "Define a KPI framework covering outcomes and delivery health, and produce a consistent, trusted baseline executive dashboard.", "2": "Standardise KPI definitions and calculation methods, improve dashboard data quality, and ensure consistent use in governance decisions.", "3": "Integrate KPIs and dashboards into governance routines so they drive action, with thresholds triggering escalation and intervention.", "4": "Enhance with leading indicators, exception-based insights, and drill-downs so executives can intervene early and optimise outcomes.", "5": "Sustain by reviewing KPI relevance, retiring low-value measures, and improving analytics capability aligned to strategic objectives."}, "Insight-driven decision support": {"1": "Introduce a decision support approach that links key decisions to data, measures, and evidence so decisions are not purely intuition-based.", "2": "Standardise analytic inputs to governance (drivers, trends, trade-offs) so decision-making is consistent and transparent.", "3": "Embed insight summaries and recommendations into governance packs and ensure decision outcomes and follow-up actions are recorded and tracked.", "4": "Enhance decision support with scenario analysis and predictive insights to enable proactive interventions and optimisation.", "5": "Sustain by evaluating decision outcomes, improving the quality of insights, and strengthening analytics capability and data literacy."}}, "Delivery Frameworks & Ways of Working": {"Delivery methodology & integration": {"1": "Define a standard methodology with minimum artefacts, roles, and controls that accommodates agile, predictive, and hybrid delivery approaches.", "2": "Drive adoption through training and governance, align hybrid governance so all delivery types use comparable reporting and controls.", "3": "Embed the methodology into tooling and governance so progress, risks, and performance are assessed consistently across delivery types.", "4": "Use cross-delivery performance data and lessons learned to refine the methodology and improve predictability across approaches.", "5": "Sustain by maintaining methodology ownership, refreshing templates, and ensuring governance evolves with new delivery approaches."}, "Schedule & scope control": {"1": "Establish baseline scheduling standards and a scope change control process so delivery timelines and scope commitments are visible and managed.", "2": "Improve forecasting accuracy with dependency mapping and milestones, and enforce scope change documentation and impact assessment.", "3": "Integrate scheduling with governance reporting, use trend data for forecasting, and enforce scope control with governance-backed approval.", "4": "Adopt earned-value techniques and proactive scope management, with governance using forecast data to intervene before overruns materialise.", "5": "Sustain by continuously improving forecasting accuracy, integrating lessons learned, and optimising scope management based on delivery outcomes."}, "Delivery risk & change management": {"1": "Define a standard delivery risk framework and change impact assessment process so risks and change impacts are visible and managed.", "2": "Ensure all initiatives apply risk identification and assessment, and change impacts on people, process, and technology are routinely evaluated.", "3": "Embed risk quantification and change readiness assessments into governance, enabling proactive mitigation and intervention.", "4": "Use risk data and change outcomes to drive portfolio-level insights, with integrated risk and change management improving delivery predictability.", "5": "Sustain by continuously refining risk and change management practices, measuring their impact on outcomes, and driving organisational learning."}, "Lessons learned & continuous improvement": {"1": "Establish a structured lessons-learned process with defined capture points, templates, and accountability for sharing findings.", "2": "Implement regular sharing mechanisms and integrate lessons into methodology updates so learning drives improvement.", "3": "Track the impact of lessons on delivery outcomes, and embed lessons-learned reviews into governance and project close processes.", "4": "Drive measurable improvement from lessons, with teams proactively sharing insights and the organisation adapting delivery practices.", "5": "Sustain a learning culture where continuous improvement is embedded, and lessons drive strategic delivery capability development."}}, "Demand & Investment Governance": {"Demand intake & prioritisation": {"1": "Define a standard demand intake process and transparent prioritisation criteria so all requests are captured, assessed, and ranked consistently.", "2": "Ensure all demand flows through the intake process and prioritisation criteria are applied consistently with governance oversight.", "3": "Integrate prioritisation with capacity and strategy so trade-off decisions are informed by data and rationale is documented.", "4": "Enable dynamic prioritisation with real-time signals, portfolio-level trade-off analysis, and governance authority to reprioritise rapidly.", "5": "Sustain by continuously refining criteria, measuring prioritisation outcomes, and ensuring the process adapts to organisational change."}, "Business case & investment approval": {"1": "Define a business case template with required elements and establish consistent approval governance with clear evaluation criteria.", "2": "Improve business case quality through guidance and review, and ensure approval governance is consistently applied across all investments.", "3": "Stress-test business cases with sensitivity analysis and ensure approval governance considers portfolio-level trade-offs and strategic fit.", "4": "Track business case performance post-approval to validate assumptions, and use findings to improve future business case quality.", "5": "Sustain by refining approval criteria, benchmarking investment performance, and driving continuous improvement in investment decision-making."}, "Funding & stage gate governance": {"1": "Establish transparent funding allocation and define stage gate criteria so investment progression is controlled and evidence-based.", "2": "Improve funding visibility and enforce stage gate reviews with stop/go decision authority and consistent evidence requirements.", "3": "Integrate funding and stage gate governance so reallocation is possible based on performance, and progression validates value delivery.", "4": "Enable dynamic funding governance with real-time visibility, and stage gates that continuously validate strategic alignment and value.", "5": "Sustain by measuring gate effectiveness, refining funding models, and ensuring governance adapts to portfolio complexity and organisational change."}, "Decision rights clarity": {"1": "Define decision rights across governance forums with clear escalation paths, thresholds, and accountability for approval and stop decisions.", "2": "Communicate decision rights broadly and embed them in governance processes so they are consistently understood and applied.", "3": "Embed decision rights into tools and processes so timely decisions are made with appropriate authority and transparency.", "4": "Measure decision timeliness and quality, and refine decision rights based on performance data and organisational learning.", "5": "Sustain by continuously improving decision governance, ensuring rights evolve with organisational structure and portfolio complexity."}}, "Financial Management & Benefits": {"Financial forecasting & variance": {"1": "Establish baseline forecasting methods and variance tracking so cost performance is visible and budget risks are identified early.", "2": "Improve forecast accuracy with regular updates and defined methods, and apply consistent variance analysis with escalation thresholds.", "3": "Incorporate trend analysis and risk adjustments into forecasting, and embed variance management in governance with corrective action tracking.", "4": "Adopt predictive financial modelling and automated variance detection to enable proactive portfolio financial management.", "5": "Sustain by continuously improving forecasting accuracy, refining models with delivery outcomes, and evolving financial analytics capability."}, "Budget & financial governance": {"1": "Define budget controls, approval thresholds, and expenditure categorisation standards including capex/opex treatment.", "2": "Enforce consistent budget governance and financial controls, and improve expenditure categorisation across all initiatives.", "3": "Integrate budget management with portfolio governance and ensure financial discipline through clear accountability and reporting.", "4": "Automate financial controls, provide real-time budget visibility, and drive continuous improvement of financial governance processes.", "5": "Sustain by benchmarking financial governance maturity, refining controls, and ensuring processes adapt to regulatory and organisational changes."}, "Benefits realisation & reporting": {"1": "Define benefits owners, measures, and baselines for all investments, and establish a tracking process integrated with governance.", "2": "Ensure consistent benefits tracking across the portfolio and implement investment performance reporting with clear accountability.", "3": "Integrate benefits performance into portfolio decisions, with reporting providing visibility into value delivery and investment returns.", "4": "Use predictive analytics to optimise benefits realisation, and close the feedback loop between investment performance and portfolio planning.", "5": "Sustain by continuously improving benefits methodology, validating measurement approaches, and maximising portfolio value realisation."}, "Post-implementation review": {"1": "Establish a standard post-implementation review process with consistent criteria and required deliverables.", "2": "Ensure reviews are conducted consistently and findings are shared with stakeholders and governance forums.", "3": "Integrate review insights into governance and planning so they improve business case quality and delivery practices.", "4": "Use review outcomes to drive systemic improvement, with findings influencing investment strategy and methodology refinement.", "5": "Sustain by embedding post-implementation learning into the investment lifecycle and measuring the impact on decision quality over time."}}, "PMO Structure, Mandate & Value": {"PMO mandate & strategic influence": {"1": "Define a formal PMO mandate aligned to organisational objectives, and secure leadership recognition of the PMO's role in portfolio governance.", "2": "Elevate the PMO from administrative support to strategic enabler, with engagement in portfolio prioritisation and investment discussions.", "3": "Embed the PMO in strategic decision-making with a defined role in portfolio shaping, investment oversight, and executive governance.", "4": "Strengthen the PMO's strategic influence through demonstrated value, with the mandate evolving alongside organisational strategy.", "5": "Sustain by continuously reviewing the mandate, measuring strategic contribution, and ensuring the PMO adapts to organisational evolution."}, "Service catalogue & governance model": {"1": "Define the PMO service catalogue and establish a basic governance model with forums, cadences, and accountabilities.", "2": "Formalise the service catalogue with clear scope, and ensure governance structures are consistently applied with defined roles.", "3": "Integrate PMO services and governance with organisational processes, with feedback loops driving service improvement.", "4": "Optimise the service catalogue and governance model based on stakeholder needs, with services demonstrating measurable value.", "5": "Sustain by continuously refining services and governance, ensuring they evolve with organisational maturity and stakeholder expectations."}, "PMO performance & stakeholder measurement": {"1": "Define PMO performance KPIs and implement a structured approach to measuring stakeholder satisfaction.", "2": "Track PMO performance consistently and act on stakeholder feedback to improve services and governance.", "3": "Use performance data and stakeholder insights to prioritise PMO improvement initiatives and demonstrate value.", "4": "Drive PMO evolution through outcome-based metrics, with stakeholder engagement shaping strategic priorities and service design.", "5": "Sustain by benchmarking PMO performance, measuring value contribution, and embedding stakeholder voice into continuous improvement."}, "Continuous improvement discipline": {"1": "Establish a structured approach to PMO improvement with regular reviews, an improvement backlog, and assigned ownership.", "2": "Prioritise improvement initiatives by impact and track them to completion with measurable outcomes.", "3": "Embed continuous improvement in PMO operations with innovation encouraged and improvement outcomes reported to governance.", "4": "Drive strategic value through improvement, with initiatives aligned to organisational objectives and impact measured.", "5": "Sustain a culture of continuous improvement where the PMO leads organisational delivery capability development."}}, "Portfolio Planning & Optimisation": {"Capacity & resource alignment": {"1": "Establish baseline capacity data and align resource allocation to prioritised portfolio demand using defined planning methods.", "2": "Improve capacity accuracy and ensure resource allocation decisions are informed by demand data and governance oversight.", "3": "Actively balance capacity and demand through governance, with scenario analysis informing allocation trade-offs.", "4": "Integrate capacity intelligence with portfolio planning and enable dynamic allocation that optimises utilisation and throughput.", "5": "Sustain by continuously refining capacity models, improving forecasting accuracy, and evolving resource alignment practices."}, "Portfolio modelling & balance": {"1": "Introduce basic scenario modelling and define dimensions for portfolio balance (value, risk, timing, strategic fit).", "2": "Apply consistent modelling to portfolio decisions and assess balance across defined dimensions with governance oversight.", "3": "Use sophisticated modelling for trade-off analysis, with governance using portfolio balance insights for prioritisation.", "4": "Enable advanced modelling with real-time data integration, supporting continuous portfolio optimisation and dynamic rebalancing.", "5": "Sustain by refining modelling capability, measuring portfolio balance outcomes, and evolving approaches with organisational needs."}, "Dependency & long-range planning": {"1": "Establish dependency mapping at the portfolio level and integrate long-range planning with strategic and financial planning cycles.", "2": "Actively manage dependencies with impact analysis and extend planning horizons beyond current delivery to inform annual budgets.", "3": "Embed dependency management and long-range planning into governance, with portfolio-level visibility and proactive risk management.", "4": "Achieve end-to-end dependency visibility and strategic long-range planning that drives portfolio agility and investment decisions.", "5": "Sustain by continuously improving dependency intelligence, refining planning methods, and ensuring strategic alignment of the planning horizon."}, "Reprioritisation responsiveness": {"1": "Define a reprioritisation process with agreed criteria and governance authority so the portfolio can respond to changing priorities.", "2": "Improve responsiveness with data-driven trade-off analysis and ensure reprioritisation decisions are governed and communicated.", "3": "Integrate reprioritisation with capacity and financial governance for rapid, well-informed portfolio adjustments.", "4": "Enable real-time prioritisation signals and proactive portfolio adjustments aligned to strategic outcomes and emerging risks.", "5": "Sustain by measuring reprioritisation effectiveness, refining triggers and criteria, and ensuring the portfolio remains dynamically optimised."}}, "Resource & Capability Management": {"Resource demand & capacity": {"1": "Establish visibility into resource demand and capacity, with defined methods for tracking and planned allocation aligned to priorities.", "2": "Improve demand accuracy and capacity data completeness, enabling governance to make informed allocation and conflict-resolution decisions.", "3": "Actively balance demand and capacity through governance, with utilisation data and forecasting driving optimisation.", "4": "Enable real-time demand and capacity intelligence with predictive analytics improving resource outcomes and portfolio throughput.", "5": "Sustain by continuously refining demand and capacity models, measuring resource outcomes, and evolving practices with portfolio needs."}, "Skills & capability development": {"1": "Map skills to roles and portfolio needs, and establish capability development programmes to address identified gaps.", "2": "Align development activities to portfolio demand and track skills improvement with defined measures.", "3": "Integrate capability development with workforce and portfolio planning, with measurable improvement in delivery competency.", "4": "Drive a learning culture with skills intelligence informing strategic resourcing, talent development, and succession planning.", "5": "Sustain by benchmarking capability, refining development programmes, and ensuring skills evolve with delivery methodology and technology."}, "Role clarity & workforce planning": {"1": "Define roles with documented accountabilities and establish workforce planning that integrates with portfolio demand forecasts.", "2": "Resolve accountability overlaps and extend workforce planning to cover future resource needs aligned to portfolio priorities.", "3": "Align role design and workforce planning to strategic objectives, with succession and mobility actively managed.", "4": "Drive workforce planning as a strategic capability, informing talent acquisition, development, and deployment for portfolio success.", "5": "Sustain by continuously refining roles and workforce plans, measuring alignment outcomes, and adapting to organisational evolution."}, "Vendor resource governance": {"1": "Define vendor governance with clear performance expectations, onboarding standards, and regular review cadences.", "2": "Enforce consistent vendor management and improve integration of vendor resources with internal teams and capacity planning.", "3": "Use vendor performance data to drive retention and allocation decisions, and integrate vendor resources into blended workforce planning.", "4": "Optimise the blended workforce with strategic vendor management, continuous assessment, and alignment to portfolio needs.", "5": "Sustain by benchmarking vendor governance, refining management practices, and ensuring vendor capability evolves with delivery needs."}}, "Risk, Controls & Assurance": {"Enterprise risk & control framework": {"1": "Define a portfolio risk and control framework aligned to enterprise standards, with consistent application across all initiatives.", "2": "Improve risk alignment and control completeness, ensuring the framework covers key portfolio risks with enterprise integration.", "3": "Measure risk quantification and control effectiveness, and report to governance for proactive portfolio risk management.", "4": "Use data analytics to improve risk identification and control efficiency, with portfolio and enterprise risk fully integrated.", "5": "Sustain by continuously refining the framework, benchmarking effectiveness, and ensuring controls evolve with risk and regulatory changes."}, "Assurance & compliance": {"1": "Establish a structured assurance framework with clear criteria, and implement compliance tracking with traceability to requirements.", "2": "Apply assurance reviews consistently and improve compliance tracking completeness and accuracy across the portfolio.", "3": "Embed assurance findings into governance action and manage compliance proactively, with risk-based assurance prioritisation.", "4": "Enable continuous assurance and compliance intelligence with real-time visibility, automated controls, and exception management.", "5": "Sustain by measuring assurance effectiveness, refining compliance approaches, and ensuring continuous improvement of control quality."}, "Audit readiness & remediation": {"1": "Establish structured audit preparation practices and a defined remediation process with ownership and tracking.", "2": "Maintain audit-ready documentation and ensure remediation actions are tracked to closure with accountability.", "3": "Embed proactive audit preparation and disciplined remediation governance with root-cause analysis of findings.", "4": "Achieve continuous audit readiness with automated controls and remediation that drives systemic improvement.", "5": "Sustain by benchmarking audit outcomes, refining controls, and ensuring remediation drives lasting improvement across the portfolio."}, "Issue escalation clarity": {"1": "Define escalation paths with clear criteria, thresholds, and response expectations documented in governance frameworks.", "2": "Embed escalation into governance with tracking and accountability, ensuring consistent response times and outcomes.", "3": "Ensure timely resolution through transparent reporting, with governance using escalation data to identify systemic issues.", "4": "Refine escalation governance with metrics-driven improvement, and systemic issues triggering proactive portfolio-level intervention.", "5": "Sustain by measuring escalation effectiveness, refining criteria and thresholds, and ensuring governance adapts to portfolio complexity."}}, "Strategy & Portfolio Alignment": {"Strategic alignment & traceability": {"1": "Introduce mandatory strategy mapping for all investments and establish traceability from strategic objectives through to delivery activities.", "2": "Implement a strategic scoring model and ensure traceability is maintained so portfolio composition reflects strategic intent.", "3": "Embed strategic scoring into prioritisation and funding, and publish portfolio-to-strategy traceability for governance visibility.", "4": "Run scenario-based portfolio reviews and use end-to-end traceability for impact analysis when strategy shifts.", "5": "Sustain by recalibrating scoring criteria and traceability when strategy evolves, ensuring continuous alignment and maximum strategic value."}, "Portfolio objectives & review": {"1": "Define portfolio objectives with clear success criteria and establish a regular review cadence to assess progress and alignment.", "2": "Communicate objectives broadly and ensure reviews are structured, focused, and consistently attended by accountable leaders.", "3": "Drive portfolio adjustments through objective-based reviews, with governance authority for course-correction decisions.", "4": "Dynamically align objectives and review cadences to strategy, with continuous improvement of governance effectiveness.", "5": "Sustain by measuring review impact on portfolio performance, refining objectives, and ensuring governance drives strategic outcomes."}, "Benefits & value measurement": {"1": "Define benefits with clear owners, measures, baselines, and a consistent methodology for value measurement across investments.", "2": "Ensure benefits are tracked consistently and value measurement is applied rigorously with governance oversight.", "3": "Integrate value measurement into portfolio decisions, with benefits tracking informing investment strategy and prioritisation.", "4": "Optimise value measurement with predictive analytics, and close the feedback loop between benefits performance and portfolio planning.", "5": "Sustain by refining measurement approaches, validating value outcomes, and ensuring the methodology evolves with portfolio and strategic needs."}, "Executive sponsorship maturity": {"1": "Define sponsor roles with clear expectations and ensure sponsors are assigned and actively engaged in governance and key decisions.", "2": "Enforce sponsor accountability for outcomes and provide structured support including guidance on effective sponsorship.", "3": "Measure sponsor effectiveness and provide coaching and feedback to improve sponsorship quality across the portfolio.", "4": "Develop executive sponsorship as a strategic capability, with effectiveness driving value delivery and governance quality.", "5": "Sustain by benchmarking sponsorship maturity, refining development approaches, and ensuring sponsor capability evolves with portfolio needs."}}}
</script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// ── DATA SETUP ────────────────────────────────────────────
const domainsData = JSON.parse(document.getElementById('domains-data').textContent);
const recMap      = JSON.parse(document.getElementById('recs-data').textContent);
const domainNames = Object.keys(domainsData);
const levelNames  = ['Initial', 'Developing', 'Defined', 'Managed', 'Optimising'];

// Flatten capabilities
const capabilities = [];
domainNames.forEach(d => {
  domainsData[d].forEach(cap => {
    capabilities.push({ domain: d, name: cap.name, levels: cap.levels });
  });
});

const totalSteps = capabilities.length + 1; // domain step + N capabilities + results
const domainWeightInputs = {};
const selections = capabilities.map(() => ({ level: 1 }));
let currentStep = 0;
let autoAdvanceTimer = null;

// ── DOM REFERENCES ────────────────────────────────────────
const stepLabelEl   = document.getElementById('step-label');
const stepCountEl   = document.getElementById('step-count');
const progressBarEl = document.getElementById('progress-bar');
const domainStepDiv = document.getElementById('domain-step');
const capStepDiv    = document.getElementById('capability-step');
const resultsStepDiv= document.getElementById('results-step');
const domainNextBtn = document.getElementById('domain-next');
const prevBtn       = document.getElementById('prev-btn');
const nextBtn       = document.getElementById('next-btn');
const resultsPrevBtn= document.getElementById('results-prev-btn');
const saveBtn       = document.getElementById('save-btn');
const resetBtn      = document.getElementById('reset-btn');

// ── BUILD DOMAIN GRID ─────────────────────────────────────
function buildDomainGrid() {
  const grid = document.getElementById('domain-grid');
  grid.innerHTML = '';
  domainNames.forEach((domain, idx) => {
    const caps = domainsData[domain];
    const item = document.createElement('div');
    item.className = 'domain-item';

    const icon = document.createElement('div');
    icon.className = 'domain-item-icon';
    icon.textContent = String.fromCharCode(65 + idx);

    const nameEl = document.createElement('div');
    nameEl.className = 'domain-item-name';
    nameEl.textContent = domain;

    const countEl = document.createElement('div');
    countEl.className = 'domain-item-count';
    countEl.textContent = `${caps.length} capabilities`;

    const wrapEl = document.createElement('div');
    wrapEl.style.cssText = 'display:flex;align-items:center;gap:6px;flex-shrink:0';

    const input = document.createElement('input');
    input.type = 'number';
    input.min = '0';
    input.step = '0.01';
    input.value = (1 / domainNames.length).toFixed(3);
    input.className = 'domain-weight-input';
    domainWeightInputs[domain] = input;

    const unit = document.createElement('span');
    unit.className = 'weight-unit';
    unit.textContent = 'wt';

    wrapEl.appendChild(input);
    wrapEl.appendChild(unit);
    item.appendChild(icon);
    item.appendChild(nameEl);
    item.appendChild(countEl);
    item.appendChild(wrapEl);
    grid.appendChild(item);
  });
}

// ── PERSISTENCE ───────────────────────────────────────────
function loadSavedProgress() {
  const saved = localStorage.getItem('pmoMaturityAssessment');
  if (!saved) return;
  try {
    const data = JSON.parse(saved);
    if (data.domainWeights) {
      domainNames.forEach(d => {
        if (data.domainWeights[d] !== undefined) {
          domainWeightInputs[d].value = data.domainWeights[d];
        }
      });
    }
    if (data.selections && Array.isArray(data.selections)) {
      data.selections.forEach((sel, idx) => {
        if (selections[idx] && typeof sel.level === 'number') {
          selections[idx].level = sel.level;
        }
      });
    }
    if (typeof data.currentStep === 'number') {
      currentStep = Math.min(data.currentStep, totalSteps);
    }
  } catch (err) {
    console.warn('Failed to load saved progress', err);
  }
}

function saveProgress(quiet = true) {
  const data = { domainWeights: {}, selections, currentStep };
  domainNames.forEach(d => {
    const val = parseFloat(domainWeightInputs[d].value);
    data.domainWeights[d] = isNaN(val) ? 0 : val;
  });
  try {
    localStorage.setItem('pmoMaturityAssessment', JSON.stringify(data));
    if (!quiet) alert('Progress saved. You can resume later.');
  } catch (err) {
    console.warn('Failed to save progress', err);
  }
}

function resetProgress() {
  if (!confirm('Reset all assessment progress? This cannot be undone.')) return;
  localStorage.removeItem('pmoMaturityAssessment');
  domainNames.forEach(d => {
    domainWeightInputs[d].value = (1 / domainNames.length).toFixed(3);
  });
  selections.forEach(sel => { sel.level = 1; });
  currentStep = 0;
  showStep();
}

// ── EVENT LISTENERS ───────────────────────────────────────
saveBtn.addEventListener('click', () => saveProgress(false));
resetBtn.addEventListener('click', resetProgress);

domainNextBtn.addEventListener('click', () => {
  currentStep = 1;
  saveProgress();
  showStep();
});

prevBtn.addEventListener('click', () => {
  clearTimeout(autoAdvanceTimer);
  if (currentStep > 0) { currentStep--; saveProgress(); showStep(); }
});

nextBtn.addEventListener('click', () => {
  clearTimeout(autoAdvanceTimer);
  if (currentStep <= capabilities.length) { currentStep++; saveProgress(); showStep(); }
});

resultsPrevBtn.addEventListener('click', () => {
  currentStep = capabilities.length;
  saveProgress();
  showStep();
});

// ── KEYBOARD NAVIGATION ──────────────────────────────────
document.addEventListener('keydown', (e) => {
  if (currentStep < 1 || currentStep > capabilities.length) return;
  const grid = document.getElementById('maturity-grid');
  if (!grid) return;
  const cards = Array.from(grid.querySelectorAll('.maturity-card'));
  const focused = document.activeElement;
  const idx = cards.indexOf(focused);

  if (e.key === 'ArrowRight' && idx < cards.length - 1) {
    e.preventDefault();
    cards[idx + 1].focus();
  } else if (e.key === 'ArrowLeft' && idx > 0) {
    e.preventDefault();
    cards[idx - 1].focus();
  } else if (e.key === 'Enter' && idx >= 0) {
    e.preventDefault();
    cards[idx].click();
  }
});

// ── PROGRESS UI ───────────────────────────────────────────
function updateProgressUI() {
  if (currentStep === 0) {
    stepLabelEl.textContent = 'Domain Weighting';
    stepCountEl.textContent = '';
  } else if (currentStep >= 1 && currentStep <= capabilities.length) {
    const cap = capabilities[currentStep - 1];
    stepLabelEl.textContent = cap.domain;
    stepCountEl.textContent = `Capability ${currentStep} of ${capabilities.length}`;
  } else {
    stepLabelEl.textContent = 'Results';
    stepCountEl.textContent = '';
  }
  const percent = (currentStep / totalSteps) * 100;
  progressBarEl.style.width = `${Math.min(percent, 100)}%`;
}

// ── SHOW STEP ─────────────────────────────────────────────
function showStep() {
  clearTimeout(autoAdvanceTimer);
  updateProgressUI();
  domainStepDiv.classList.add('hidden');
  capStepDiv.classList.add('hidden');
  resultsStepDiv.classList.add('hidden');

  if (currentStep === 0) {
    domainStepDiv.classList.remove('hidden');
  } else if (currentStep >= 1 && currentStep <= capabilities.length) {
    capStepDiv.classList.remove('hidden');
    const isLast = currentStep === capabilities.length;
    nextBtn.innerHTML = isLast
      ? 'View Results <svg width="13" height="13" viewBox="0 0 16 16" fill="none"><path d="M3 8h10M9 4l4 4-4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>'
      : 'Next <svg width="13" height="13" viewBox="0 0 16 16" fill="none"><path d="M3 8h10M9 4l4 4-4 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>';
    showCapability();
  } else {
    resultsStepDiv.classList.remove('hidden');
    calculateResults();
  }
  window.scrollTo({ top: 0, behavior: 'instant' });
}

// ── SHOW CAPABILITY ───────────────────────────────────────
function showCapability() {
  const idx = currentStep - 1;
  const cap = capabilities[idx];

  document.getElementById('cap-domain-badge').textContent = cap.domain;
  document.getElementById('cap-name').textContent = cap.name;

  const domCaps = capabilities.filter(c => c.domain === cap.domain);
  const posInDomain = domCaps.findIndex(c => c.name === cap.name) + 1;
  document.getElementById('cap-meta').textContent =
    `${posInDomain} of ${domCaps.length} in domain`;

  const grid = document.getElementById('maturity-grid');
  grid.innerHTML = '';

  cap.levels.forEach((desc, i) => {
    const levelNum = i + 1;
    const isSelected = selections[idx].level === levelNum;
    const card = document.createElement('div');
    card.className = `maturity-card lvl-${levelNum}${isSelected ? ' selected' : ''}`;
    card.tabIndex = 0;
    card.setAttribute('role', 'radio');
    card.setAttribute('aria-checked', isSelected ? 'true' : 'false');
    card.setAttribute('aria-label', `Level ${levelNum}: ${levelNames[i]}`);

    card.innerHTML = `
      <div class="maturity-card-accent"></div>
      <div class="maturity-card-header">
        <span>${levelNum} · ${levelNames[i]}</span>
        <div class="maturity-card-check">
          <svg width="10" height="10" viewBox="0 0 12 12" fill="none">
            <path d="M2 6l3 3 5-5" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
      </div>
      <div class="maturity-card-desc">${desc}</div>
    `;

    card.addEventListener('click', () => {
      selections[idx].level = levelNum;
      grid.querySelectorAll('.maturity-card').forEach(el => {
        el.classList.remove('selected');
        el.setAttribute('aria-checked', 'false');
      });
      card.classList.add('selected');
      card.setAttribute('aria-checked', 'true');
      saveProgress();

      // Auto-advance after 400ms
      clearTimeout(autoAdvanceTimer);
      if (currentStep < capabilities.length) {
        autoAdvanceTimer = setTimeout(() => {
          currentStep++;
          showStep();
        }, 400);
      }
    });

    grid.appendChild(card);
  });
}

// ── MATURITY LABEL HELPER ─────────────────────────────────
function getMaturityLabel(score) {
  if (score < 1.5) return { label: 'Initial',    cls: 'badge-initial',    key: 'initial' };
  if (score < 2.5) return { label: 'Developing', cls: 'badge-developing', key: 'developing' };
  if (score < 3.5) return { label: 'Defined',    cls: 'badge-defined',    key: 'defined' };
  if (score < 4.5) return { label: 'Managed',    cls: 'badge-managed',    key: 'managed' };
  return             { label: 'Optimising', cls: 'badge-optimising', key: 'optimising' };
}

// ── CALCULATE RESULTS ─────────────────────────────────────
function calculateResults() {
  // Normalise domain weights
  const domWeights = {};
  let domSum = 0;
  domainNames.forEach(d => {
    const val = parseFloat(domainWeightInputs[d].value) || 0;
    domWeights[d] = val;
    domSum += val;
  });
  if (domSum === 0) domSum = 1;
  domainNames.forEach(d => { domWeights[d] /= domSum; });

  // Compute domain scores (equal-weight capabilities within each domain)
  const domainScores = {}, domainAverages = {};
  const domainIndexStart = {};
  let start = 0;
  domainNames.forEach(d => { domainIndexStart[d] = start; start += domainsData[d].length; });

  domainNames.forEach(d => {
    const caps = domainsData[d];
    let sSum = 0;
    caps.forEach((cap, j) => {
      const gi = domainIndexStart[d] + j;
      sSum += selections[gi].level;
    });
    const avg = sSum / caps.length;
    domainScores[d] = avg;
    domainAverages[d] = avg;
  });

  let overallWeighted = 0, overallSimple = 0;
  domainNames.forEach(d => {
    overallWeighted += domainScores[d] * domWeights[d];
    overallSimple   += domainAverages[d];
  });
  overallSimple /= domainNames.length;

  const overallLabel = getMaturityLabel(overallWeighted);

  // Find strongest and weakest domains
  let strongest = domainNames[0], weakest = domainNames[0];
  domainNames.forEach(d => {
    if (domainScores[d] > domainScores[strongest]) strongest = d;
    if (domainScores[d] < domainScores[weakest]) weakest = d;
  });

  // ── BUILD RESULTS HTML ──────────────────────────────────
  const body = document.getElementById('results-body');
  let html = '';

  // Hero
  html += `
    <div class="results-hero">
      <div class="results-hero-score">${overallWeighted.toFixed(1)}<span class="results-hero-max"> / 5</span></div>
      <div class="results-hero-label"><span class="badge ${overallLabel.cls}" style="font-size:13px;padding:5px 16px;">${overallLabel.label}</span></div>
      <div class="results-hero-sub">Weighted maturity score across ${domainNames.length} domains and ${capabilities.length} capabilities</div>
    </div>
  `;

  // Stat cards
  html += `
    <div class="results-stats">
      <div class="stat-card">
        <div class="stat-label">Strongest Domain</div>
        <div class="stat-value" style="font-size:14px;line-height:1.4">${strongest}</div>
        <div class="stat-sub">${domainScores[strongest].toFixed(2)} / 5.00</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Weakest Domain</div>
        <div class="stat-value" style="font-size:14px;line-height:1.4">${weakest}</div>
        <div class="stat-sub">${domainScores[weakest].toFixed(2)} / 5.00</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Simple Average</div>
        <div class="stat-value">${overallSimple.toFixed(2)}</div>
        <div class="stat-sub">unweighted mean</div>
      </div>
    </div>
  `;

  // Domain score cards
  html += '<div class="section-header">Domain Scores</div>';
  html += '<div class="domain-scores-grid">';
  domainNames.forEach(d => {
    const score = domainScores[d];
    const pct = (score / 5) * 100;
    const ml = getMaturityLabel(score);
    html += `
      <div class="domain-score-card" data-maturity="${ml.key}">
        <div class="domain-score-card-name">${d}</div>
        <div class="domain-score-card-row">
          <div class="domain-score-card-num">${score.toFixed(1)}</div>
          <div class="score-bar-wrap">
            <div class="score-bar"><div class="score-bar-fill score-fill-${ml.key}" style="width:${pct}%"></div></div>
          </div>
          <span class="badge ${ml.cls}">${ml.label}</span>
        </div>
      </div>
    `;
  });
  html += '</div>';

  // Radar chart
  html += `
    <div class="chart-wrap">
      <div class="chart-heading">Maturity Profile</div>
      <canvas id="scoreChart" height="300"></canvas>
    </div>
  `;

  // Build recommendations
  const allRecs = [];
  const strengths = [];
  domainNames.forEach(d => {
    const caps = domainsData[d];
    caps.forEach((cap, j) => {
      const gi = domainIndexStart[d] + j;
      const currLevel = selections[gi].level;
      if (currLevel >= 5) {
        strengths.push({ domain: d, cap: cap.name, level: currLevel });
        return;
      }
      if (currLevel >= 4) {
        strengths.push({ domain: d, cap: cap.name, level: currLevel });
      }
      const rec = recMap[d] && recMap[d][cap.name] && recMap[d][cap.name][currLevel];
      if (rec) {
        allRecs.push({ domain: d, cap: cap.name, level: currLevel, rec, priority: currLevel <= 2 ? 'critical' : currLevel === 3 ? 'improvement' : 'finetune' });
      }
    });
  });

  // Sort by level ascending (most critical first)
  allRecs.sort((a, b) => a.level - b.level);

  html += '<div class="section-header">Recommendations</div>';

  const criticalRecs = allRecs.filter(r => r.priority === 'critical');
  const improvementRecs = allRecs.filter(r => r.priority === 'improvement');
  const finetuneRecs = allRecs.filter(r => r.priority === 'finetune');

  if (criticalRecs.length) {
    html += `
      <div class="rec-priority-group">
        <div class="rec-priority-label">
          <div class="rec-priority-dot" style="background:var(--error)"></div>
          Critical — Foundational gaps (${criticalRecs.length})
        </div>
        <div class="rec-cards">
    `;
    criticalRecs.forEach(r => {
      html += buildRecCard(r, 'critical');
    });
    html += '</div></div>';
  }

  if (improvementRecs.length) {
    html += `
      <div class="rec-priority-group">
        <div class="rec-priority-label">
          <div class="rec-priority-dot" style="background:var(--info)"></div>
          Improvement — Room for growth (${improvementRecs.length})
        </div>
        <div class="rec-cards">
    `;
    improvementRecs.forEach(r => {
      html += buildRecCard(r, 'improvement');
    });
    html += '</div></div>';
  }

  if (finetuneRecs.length) {
    html += `
      <div class="rec-priority-group">
        <div class="rec-priority-label">
          <div class="rec-priority-dot" style="background:var(--success)"></div>
          Fine-tuning — Polish and optimise (${finetuneRecs.length})
        </div>
        <div class="rec-cards">
    `;
    finetuneRecs.forEach(r => {
      html += buildRecCard(r, 'finetune');
    });
    html += '</div></div>';
  }

  // Strengths section
  if (strengths.filter(s => s.level >= 5).length > 0) {
    html += '<div class="section-header" style="margin-top:24px">Strengths</div>';
    html += '<div class="strengths-section"><div class="strengths-grid">';
    strengths.filter(s => s.level >= 5).forEach(s => {
      html += `
        <div class="strength-chip">
          <svg width="14" height="14" viewBox="0 0 16 16" fill="none"><path d="M2 8l4 4 8-8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          ${s.cap}
        </div>
      `;
    });
    html += '</div></div>';
  }

  body.innerHTML = html;

  // ── Radar chart ─────────────────────────────────────────
  const ctx = document.getElementById('scoreChart').getContext('2d');
  if (window._scoreChart) window._scoreChart.destroy();

  // Shorten labels for radar
  const radarLabels = domainNames.map(d => {
    const words = d.split(/[,&]| /g).filter(Boolean);
    return words.length > 3 ? words.slice(0, 3).join(' ') : d;
  });

  window._scoreChart = new Chart(ctx, {
    type: 'radar',
    data: {
      labels: radarLabels,
      datasets: [{
        label: 'Your Score',
        data: domainNames.map(d => parseFloat(domainScores[d].toFixed(2))),
        backgroundColor: 'rgba(253, 81, 8, 0.15)',
        borderColor: '#FD5108',
        borderWidth: 2,
        pointBackgroundColor: '#FD5108',
        pointBorderColor: '#fff',
        pointBorderWidth: 2,
        pointRadius: 5
      }]
    },
    options: {
      scales: {
        r: {
          beginAtZero: true,
          max: 5,
          min: 0,
          ticks: { stepSize: 1, font: { size: 10 }, backdropColor: 'transparent' },
          grid: { color: '#DFE3E6' },
          angleLines: { color: '#DFE3E6' },
          pointLabels: { font: { size: 11, weight: '500' }, color: '#000' }
        }
      },
      plugins: {
        legend: { display: false },
        tooltip: {
          callbacks: {
            title: (items) => domainNames[items[0].dataIndex],
            label: (item) => `Score: ${item.raw} / 5`
          }
        }
      },
      animation: { duration: 600 }
    }
  });
}

function buildRecCard(r, priority) {
  const nextLevel = r.level + 1;
  const currLabel = getMaturityLabel(r.level);
  const nextLabel = getMaturityLabel(nextLevel);
  return `
    <div class="rec-card rec-card-${priority}">
      <div class="rec-card-top">
        <div>
          <div class="rec-card-domain">${r.domain}</div>
          <div class="rec-card-cap">${r.cap}</div>
        </div>
        <div class="rec-card-levels">
          <span class="rec-card-level-badge badge ${currLabel.cls}">${r.level}</span>
          <span class="rec-card-arrow">→</span>
          <span class="rec-card-level-badge badge ${nextLabel.cls}">${nextLevel}</span>
        </div>
      </div>
      <div class="rec-card-text">${r.rec}</div>
    </div>
  `;
}

// ── INIT ──────────────────────────────────────────────────
buildDomainGrid();
loadSavedProgress();
showStep();
</script>
</body>
</html>